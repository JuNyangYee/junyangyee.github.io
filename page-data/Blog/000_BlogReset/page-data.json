{"componentChunkName":"component---src-templates-blog-template-js","path":"/Blog/000_BlogReset/","result":{"data":{"cur":{"id":"4b03b51a-6295-509d-8266-d2a456f34e16","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABWElEQVQoz32RS27CQBBEfQckjDDMv8djxwZyKBASiwSR83IKMBG/irqJvcgiLZWmZzGvq3oyF0sYa1BVb4ghIHgH5z2ICGUkWGOgtcZcKYQQ8Pnxga/DAev1GtvtFpvNRrTb7fC53yPTWkEphbpZoUxJehZDYv2GQAFaKRRFgdVqhfv9jv8qC86A2FUsQSnBWgdj7AsYI0Lw0hfFFMvlEqfTCbfbDcfjEefzGY/HQ4bwycqsUTB6Dk8lKEZxwwCtNAKRxOT7dDrFYrEQCNflcsHz+Ryccc/KeEfWWniKCBShf3fGsaks4ZwbHDZNIw65uq5D110EfL1eB3iW6gZN+w4bSADWeRkgkVMF73tggbZtByBD+piswSFRBEWSuN57+c3ZbCYAdjmbv/rJZIK6rgfg3xocVqlCqEo0yxYppdfjPEee5xiPx3IybDQaySf1wN5Rr9dev/ED+V90si50nMIAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Blog Dev Cpature\"\n        title=\"Blog Dev Cpature\"\n        src=\"/static/2206e8d2ae5bf380baa34dd40240bd1e/37523/image_01.png\"\n        srcset=\"/static/2206e8d2ae5bf380baa34dd40240bd1e/e9ff0/image_01.png 180w,\n/static/2206e8d2ae5bf380baa34dd40240bd1e/f21e7/image_01.png 360w,\n/static/2206e8d2ae5bf380baa34dd40240bd1e/37523/image_01.png 720w,\n/static/2206e8d2ae5bf380baa34dd40240bd1e/302a4/image_01.png 1080w,\n/static/2206e8d2ae5bf380baa34dd40240bd1e/07a9c/image_01.png 1440w,\n/static/2206e8d2ae5bf380baa34dd40240bd1e/5e79a/image_01.png 3439w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"gatsby-블로그\" style=\"position:relative;\"><a href=\"#gatsby-%EB%B8%94%EB%A1%9C%EA%B7%B8\" aria-label=\"gatsby 블로그 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Gatsby 블로그</h2>\n<p>블로그 작업을 앞두고 기존 Gatsby기반 블로그, Velog, Tistory 등 다양한 방안을 생각했습니다.</p>\n<p>기존 Gatsby 블로그의 경우, 글 작성이 vscode에서 마크다운을 작성해야해,<br>\n개발 환경이 되지 않는 곳에서는 작성이 힘들기에, 블로그 글을 자주 작성하지 않는 문제가 있었습니다.</p>\n<p>다만 현재 사적인 내용은 네이버 블로그로 작성을 진행하고 있으며,<br>\n노션이나 Obsidian 처럼 마크다운 기반 툴에서 작성 후, Gatsby 이식이 그리 어렵다고 생각되지 않아서,<br>\n결국 <strong>Gatsby 기반 블로그로 다시 돌아가기로 결정했습니다.</strong></p>\n<p><em>실제로 해보니, 이미지 부분과 줄바꿈 부분만 수정해주면 끝입니다..!</em></p>\n<hr>\n<h2 id=\"기존-블로그-리셋-및-전체-디자인-수정\" style=\"position:relative;\"><a href=\"#%EA%B8%B0%EC%A1%B4-%EB%B8%94%EB%A1%9C%EA%B7%B8-%EB%A6%AC%EC%85%8B-%EB%B0%8F-%EC%A0%84%EC%B2%B4-%EB%94%94%EC%9E%90%EC%9D%B8-%EC%88%98%EC%A0%95\" aria-label=\"기존 블로그 리셋 및 전체 디자인 수정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>기존 블로그 리셋 및 전체 디자인 수정</h2>\n<p>기존 블로그 세팅 및 작성글들을 전부 리셋해주겠습니다.<br>\n추가로 디자인을 추가할 부분들은 작업해주겠습니다.</p>\n<p>기존에 작성한 Gatsby 기반 블로그는 <a href=\"https://github.com/zoomkoding/zoomkoding-gatsby-blog\">zoomkoding</a> 템플릿 기반입니다.</p>\n<h3 id=\"작성글-삭제\" style=\"position:relative;\"><a href=\"#%EC%9E%91%EC%84%B1%EA%B8%80-%EC%82%AD%EC%A0%9C\" aria-label=\"작성글 삭제 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>작성글 삭제</h3>\n<p>기존 작성글을 삭제합니다.<br>\n다만 전체 작성 방식은 까먹을 수 있으니, 확인용으로 백업해두었습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 226px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAByklEQVQoz32S23KbMBRF8w0xV3tMai4GhJCQuBjbkGny1Pb//2d1wGkmbZw+aM45elizjrQf/CAgTTOy7MjlOvE8z3x/feE0DGzDgCD4//F9/71GUcTDn2a/j9BKIwqB0oosy/BcB8dxcD2PzWaz9uvsumweH9f6EfwOXCzzLCXJcqZ5ZuhbjO0YhoFhHLHa8DzNnM4XLucR3Rh+/PpJXVd4b9C/gGEYEu33JGmKbhqEKMjzgrIoyYuCY3ak0ZpSlIiypBQVutHEhwOe530GBmFIliQcC8F1mug7S9NYuq6llpKyqOiHnmm+Ml1nxuuZ4XxGyArXce4Ag5CnKCJOboa1rCiKm00SJxR5SVVVGGsQpUCqmrppSI8Z/n3D7SdDrQ2tXaqmEhXjacR2Pa01FKXg9fVlBXy58renJ5Isw7Ytqq4QQiKlRAiBKCVd2yJriVYKpfX6HNvdFs/z7wPTOF5/ue97rGmQtUItq8kapRTGWPpu+fkLlSgwtqczltB315R8is3NMGcYT1ijkVKtuVwsF6vTONL1A303Yq1hPF9QUhL4/8RmeYP4EK/D4XAgjmN2u93ar3OSrHeBv4T78S3g7q26zirzEfgbPv05vzTjg2oAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Blog01_000_Delete\"\n        title=\"Blog01_000_Delete\"\n        src=\"/static/689ea54f26da3d3fe5bab73a0f8caae9/5f7d4/Blog01_000_Delete.png\"\n        srcset=\"/static/689ea54f26da3d3fe5bab73a0f8caae9/e9ff0/Blog01_000_Delete.png 180w,\n/static/689ea54f26da3d3fe5bab73a0f8caae9/5f7d4/Blog01_000_Delete.png 226w\"\n        sizes=\"(max-width: 226px) 100vw, 226px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"전체-디자인-수정\" style=\"position:relative;\"><a href=\"#%EC%A0%84%EC%B2%B4-%EB%94%94%EC%9E%90%EC%9D%B8-%EC%88%98%EC%A0%95\" aria-label=\"전체 디자인 수정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>전체 디자인 수정</h3>\n<p>확실히 포트폴리오 사이트로 Nextjs 작업을 하다보니, 비록 프레임워크는 다르지만<br>\nReact 기반이기에, 전체적인 파일 구조와 작성 방식이 예전에 헤딩으로 작성하던 때에 비교해서 훨씬 수월하게 작업이 진행되었습니다.</p>\n<p>전체적으로 기존 홈페이지에서 수정할 내용은 다음 정도입니다.</p>\n<ul>\n<li><strong>폰트 수정</strong> : Noto Sans -> Pretendard\n<ul>\n<li>제목 폰트 및 상단 카테고리 폰트 : Noto Sans -> Montserrat</li>\n</ul>\n</li>\n<li><strong>index 페이지 아이콘 추가</strong> : 깃허브, 이메일 -> 깃허브, 인스타그램, 이메일</li>\n<li><strong>전체 디자인 손보기</strong> :\n<ul>\n<li>여백 수정</li>\n<li>font-weight 수정 등</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"리포지토리-재생성\" style=\"position:relative;\"><a href=\"#%EB%A6%AC%ED%8F%AC%EC%A7%80%ED%86%A0%EB%A6%AC-%EC%9E%AC%EC%83%9D%EC%84%B1\" aria-label=\"리포지토리 재생성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>리포지토리 재생성</h3>\n<p>기존 junyangyee.github.io 의 경우,\n포크한 리포지토리라서 master branch가 제가 수정하는 것이 아니었습니다.</p>\n<p>해당 리포지토리 / git 삭제 후,\n새로 생성하여 github action을 사용한 푸쉬 - 자동 배포를 사용했습니다.</p>\n<p>기존 파일에 build 폴더를 삭제하고, .github/workflow 디렉토리에 <code class=\"language-text\">deploy.yml</code> 파일을 생성하여 작업하였습니다.<br>\n기존처럼 gh-pages 브랜치에서 배포되지만, master 브랜치에서 코드 전문을 확인할 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Blog Publish\n\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">push</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">branches</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> master\n\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">build</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v3\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> enriikke/gatsby<span class=\"token punctuation\">-</span>gh<span class=\"token punctuation\">-</span>pages<span class=\"token punctuation\">-</span>action@v2\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">access-token</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.BLOG_TOKEN <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n          <span class=\"token key atrule\">deploy-branch</span><span class=\"token punctuation\">:</span> gh<span class=\"token punctuation\">-</span>pages</code></pre></div>\n<p>토큰은 날짜 제한 없는 것을 생성하려 했으나, 보안상 문제가 있다고하여 60일로 생성하였습니다.</p>\n<hr>\n<h2 id=\"예전-작성글-이전-관련\" style=\"position:relative;\"><a href=\"#%EC%98%88%EC%A0%84-%EC%9E%91%EC%84%B1%EA%B8%80-%EC%9D%B4%EC%A0%84-%EA%B4%80%EB%A0%A8\" aria-label=\"예전 작성글 이전 관련 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>예전 작성글 이전 관련</h2>\n<p>기존 개인 옵시디언과 노션에 작성했던 내용들을 차근차근 이 블로그로 이전할 예정입니다.<br>\n예전에 작성한 글의 작성일도 함께 가져오기에, 날짜 순으로 정렬되는 블로그 특성 상 이 글의 이전에 위치할 수 있습니다.</p>\n<hr>\n<h2 id=\"여담\" style=\"position:relative;\"><a href=\"#%EC%97%AC%EB%8B%B4\" aria-label=\"여담 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>여담</h2>\n<p>개인적인 이야기는 네이버 블로그를 통해서 진행합니다.<br>\n<del>네이버 블로그 링크는… 아는사람들만 아는…</del></p>\n<p>그럼, 다시 열심히 시작해보겠습니다 :)</p>\n<blockquote>\n<p>포트폴리오 링크는 <a href=\"https://junyangyee.vercel.app/\">🔗여기로 들어가시면 됩니다.</a></p>\n</blockquote>\n<hr>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#gatsby-%EB%B8%94%EB%A1%9C%EA%B7%B8\">Gatsby 블로그</a></p>\n</li>\n<li>\n<p><a href=\"#%EA%B8%B0%EC%A1%B4-%EB%B8%94%EB%A1%9C%EA%B7%B8-%EB%A6%AC%EC%85%8B-%EB%B0%8F-%EC%A0%84%EC%B2%B4-%EB%94%94%EC%9E%90%EC%9D%B8-%EC%88%98%EC%A0%95\">기존 블로그 리셋 및 전체 디자인 수정</a></p>\n<ul>\n<li><a href=\"#%EC%9E%91%EC%84%B1%EA%B8%80-%EC%82%AD%EC%A0%9C\">작성글 삭제</a></li>\n<li><a href=\"#%EC%A0%84%EC%B2%B4-%EB%94%94%EC%9E%90%EC%9D%B8-%EC%88%98%EC%A0%95\">전체 디자인 수정</a></li>\n<li><a href=\"#%EB%A6%AC%ED%8F%AC%EC%A7%80%ED%86%A0%EB%A6%AC-%EC%9E%AC%EC%83%9D%EC%84%B1\">리포지토리 재생성</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%98%88%EC%A0%84-%EC%9E%91%EC%84%B1%EA%B8%80-%EC%9D%B4%EC%A0%84-%EA%B4%80%EB%A0%A8\">예전 작성글 이전 관련</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%97%AC%EB%8B%B4\">여담</a></p>\n</li>\n</ul>\n</div>","excerpt":"Gatsby 블로그 블로그 작업을 앞두고 기존 Gatsby기반 블로그, Velog, Tistory 등 다양한 방안을 생각했습니다. 기존 Gatsby 블로그의 경우, 글 작성이 vscode에서 마크다운을 작성해야해, 개발 환경이 되지 않는 곳에서는 작성이 힘들기에, 블로그 글을 자주 작성하지 않는 문제가 있었습니다. 다만 현재 사적인 내용은 네이버 블로그로 작성을 진행하고 있으며, 노션이나 Obsidian 처럼 마크다운 기반 툴에서 작성 후, Gatsby 이식이 그리 어렵다고 생각되지 않아서, 결국 Gatsby 기반 블로그로 다시 돌아가기로 결정했습니다. 실제로 해보니, 이미지 부분과 줄바꿈 부분만 수정해주면 끝입니다..! 기존 블로그 리셋 및 전체 디자인 수정 기존 블로그 세팅 및 작성글들을 전부 리셋해주겠습니다. 추가로 디자인을 추가할 부분들은 작업해주겠습니다. 기존에 작성한 Gatsby 기반 블로그는 zoomkoding 템플릿 기반입니다. 작성글 삭제 기존 작성글을 삭제합니다.…","frontmatter":{"date":"November 24, 2024","title":"블로그 다시 시작","categories":"BLOG","author":"JunHyeong Moon","emoji":""},"fields":{"slug":"/Blog/000_BlogReset/"}},"next":{"id":"f8ac93c6-e82e-5613-b370-ecd28f9e5010","html":"<p><strong>Deep Dive into the URP Lighting</strong></p>\n<blockquote>\n<p>군 생활 중, Unity Dev Week 에서 진행한 <strong>URP 셰이더 뜯어보기</strong>를 단순 정리한 내용입니다.<br>\n노션에 작성했던 내용을 블로그로 옮겨 작성해 가독성에 문제가 있을 수 있습니다.</p>\n<p><em>약 1:17:35 정도까지 작성되었습니다.</em></p>\n</blockquote>\n<div style=\"position: relative; width: 100%; padding-bottom: 56.25%\">\n<iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/9K1uOihvNyg?si=FaLQlK6cD0FDZE9o\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" referrerpolicy=\"strict-origin-when-cross-origin\" allowfullscreen style=\"position: absolute; width:100%; height: 100%;\"></iframe>\n</div>\n<div style=\"margin-top: 12px\"> </div>\n<p><a href=\"https://github.com/Unity-Technologies/Graphics/tree/master/Packages/com.unity.render-pipelines.universal/ShaderLibrary\">▶ <strong>Unity ShaderLibrary</strong> Github 링크</a></p>\n<hr>\n<h3 id=\"urp-왜-써야-할까요\" style=\"position:relative;\"><a href=\"#urp-%EC%99%9C-%EC%8D%A8%EC%95%BC-%ED%95%A0%EA%B9%8C%EC%9A%94\" aria-label=\"urp 왜 써야 할까요 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>URP 왜 써야 할까요?</h3>\n<p><strong>Universal Render Pipeline</strong></p>\n<ul>\n<li>Unity 2020부터 기본 파이프라인이 Legacy → URP 방식으로 변화</li>\n<li>URP에서는 기존 Legacy 방식의 셰이더 (Surface, Fragment) 들을 지원하지 않는다.</li>\n<li>URP 방식으로 넘어가야 하는 것은 시대의 변화. 힘들어도 받아들이는 수 밖에!</li>\n<li>하지만 그걸 받아들이기 전에 어떤 것들이 좋아졌길래 바뀌어야 하는지 정도는 알고 넘어가자!</li>\n<li>오늘 세션에서는 HDRP에 대한 내용은 다루지 않음.</li>\n</ul>\n<p><strong>레거시와 URP의 장단점 / Legacy vs URP</strong></p>\n<ul>\n<li>\n<p><strong>Legacy</strong></p>\n<ul>\n<li>손쉽게 셰이더 코딩할 수 있는 환경 (서피스, 프레그먼트)</li>\n<li>노드방식 지원하지 않음</li>\n<li>다이나믹 배칭은 극히 제한적으로 사용 가능</li>\n<li>멀티 패스 렌더링에 별다른 제약 없음</li>\n<li>렌더 시점에 대한 별로 큰 고민 안함 (그랩패스 등…)</li>\n</ul>\n</li>\n<li>\n<p><strong>URP</strong></p>\n<ul>\n<li>다소 복잡해진 셰이더 코딩 환경 (HLSL)</li>\n<li>노드 방식 지원</li>\n<li><red>SRP Batcher</red> 사용 가능</li>\n<li>멀티패스 렌더링 하려면 골치아픔</li>\n<li>렌더 시점에 대해서 고민이 필요함</li>\n<li>렌더 오브젝트, 렌더 피쳐 등 패스 추가 기능이 생겼음</li>\n</ul>\n</li>\n<li>\n<p>대략 큰 차이점은 이정도.</p>\n</li>\n<li>\n<p>이 중 특히 <red>SRP Batcher</red> 라는 기능이 추가되면서 Dynamic 오브젝트가 많아지더라도 좋은 퍼포먼스를 유지하는 것이 가능해졌다.</p>\n</li>\n</ul>\n<p><strong>SRP Batcher</strong></p>\n<div style=\"width: 100%; height: 100%; display: flex; flex-direction: row; gap: 10px;\">\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACj0lEQVQozy2S708aBxyH719qsldNmuz/WdO+60jWZOmSusZG19TUtVtmRrpZxaZYdbQ6RQvIKXDcCRwc9wMORLhfIIdmFnzxNNK9ePLk++aT74tHSMtNMnITxQiQrUtM54rrfkAvK9JIpTAO9vELecbhELV1gljap6iLNLza/1Sntrwabb+J8CzeYGGjyatEm92TC2rdMRO3yyCTpp89JDjMMBRFPg/61H0VuSVS6uRQnSJVR0btfXXFkbC8OsI393PcubfLtxGF1/s+ljdh7HYZFfJcnihTLiSJq0Gf9qhJY6Bhn+sYQZWaq6B7J5hBCc2TaXg6wq3vRG7f3eFOpMof2x3Udjgd7MRiOGsxurFV/GSSyTAkYyZZ3H7CwtYMcSmK5pbJNQqktGMkO0fLNxC+/13lYVTnp790/lVCSnbIecNEf/4ca34O8+lTTldWOXcc9ipbPHkX4fHqA16nFynZedayKV4kkryX0rT7BsLLdyVevFXYOuqRqYbktICmLFGYneWfyAPER4+oR6O0DIODWoLZ+A/MrEb4W/wNUT1g6eMWPy+/5X0hQyswEH5ZkZlbLrK8a7EjuRSMAePeGebCAvX5ecy5ObqxNS68gO3SOj++uc/D6F2WDp5ROS2yfpzm1w97bOTTtAIdYTFe5eWGRjzbI1UZonY+M3F7dDY3cRIJupubuHt7TMKQvJ0lJv45Zae8juaVUU6LSHYBpVPAvvlwJprl8VKWlWSLT+UQtTPm2ukSHh0xKkqMpAKjfI6rvo89NDGDCuagiu6VvybjylQ9GdWVaPp1hI+5Mz4cn3FYGaA0/5tmcx34XNwko1a4rNxQZhye0wltLF/DCuqYN+7rNPr69LYCjbOBzRds6KP/EnNIXwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"SRP_Batcher01\"\n        title=\"SRP_Batcher01\"\n        src=\"/static/c25e5b59c5e7bde3ab5a21d8edf6a2d8/37523/URP_img001.png\"\n        srcset=\"/static/c25e5b59c5e7bde3ab5a21d8edf6a2d8/e9ff0/URP_img001.png 180w,\n/static/c25e5b59c5e7bde3ab5a21d8edf6a2d8/f21e7/URP_img001.png 360w,\n/static/c25e5b59c5e7bde3ab5a21d8edf6a2d8/37523/URP_img001.png 720w,\n/static/c25e5b59c5e7bde3ab5a21d8edf6a2d8/cab8c/URP_img001.png 744w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 48.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACsklEQVQozx3RXU9TBwCA4fOf3O7dzX6EF7tZdMmWaIAMjDGLiBuWmVAFS5RaBkVEu4IeaGEMKO3px+nnKZZCaUtpj/0+Zf2iPSVevItePHl/wCt44wW+CCbLJAo9Tko6fa1OJRigEPCT80poSox+u0E4LSMd7hPJBEhrSU61I1K1BKlqgqx2QkdvI9wyJvhpOs7N6QQr7gaJT1f0SmVS5nmkxwbkqT8piyKdRgWLb5rJjWEe2UcwbIx99dgxypw0QTB3QGfQQvhmKMa3t0Su3Qlj+LtI7KxJNZ0hOfOM3Xv3CD4cR11+TVnNYT4wYnQ8wLgxjnHzATPOCZ5uTvB0e4JAdo/eVQfh+liY70ddfHc3yjOxxNEnnWa+QG7OxM7Yr4QejlN6vUK3Wcd5uI7Nb8EuL2J1PWfZbeKN9wWrPjOK6qejNxHW/DXWZI0vPUi0iRcG6FqD/wIBKh43NUmiFY0yuGzhOt7C8s8s7wILxFWZw/MQsTM/J2WF06pCu3+BsOBMY1pL8talEkhdouR1uvU6hUiE81iETDhEPhzlc7/LX/uz/Gy8wf3FX/ClXWzGZN753dhliQ9hD1qnjmBaTzJljbCwlUVKtonldXrFEqdvVvm4uIRiWSAnbqK3GljdLxiZu8mk7S7bMQdLHh/TH5zMOnaYd3lQ6xWEWZvC1FII6845vuMO0VyPlqpyPj+PYjCQfPKEis2G3r1g1W9h2PQjk/ZRXMl/WfEFMYrbPHfuYj6QULUqgvGtwiOLzCtnFu9xFyU/oFXII//xO47hIbZHhsiaX/G532LZ+5LbMz/wm/U2UmoPMexlLSTxPuJl1bdL6aKGsBOt4ggW2Y9rRM96HBev6FerVLYcFMX3FMV1anu7DC6bBM88rPtWcEbsnFQOyV2kyNSPyGpHZOofv17+H7LBiawO+8bEAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"SRP_Batcher01\"\n        title=\"SRP_Batcher01\"\n        src=\"/static/fa8d6152ebda95bf32014645a2a8d6a0/37523/URP_img002.png\"\n        srcset=\"/static/fa8d6152ebda95bf32014645a2a8d6a0/e9ff0/URP_img002.png 180w,\n/static/fa8d6152ebda95bf32014645a2a8d6a0/f21e7/URP_img002.png 360w,\n/static/fa8d6152ebda95bf32014645a2a8d6a0/37523/URP_img002.png 720w,\n/static/fa8d6152ebda95bf32014645a2a8d6a0/d125e/URP_img002.png 737w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n</div>\n<ul>\n<li>Per Object Large Buffer 가 추가되었다.</li>\n<li>이는 머티리얼에서 변화가 필요한 부분만 CBUFFER에 넣어놓고 나머지 머티리얼 콘텐츠를 GPU 메모리에 유지 (Per Object Large Buffer) 시키고 그 계산을 재사용하는 방식</li>\n<li>Batcher라는 이름을 달고 있지만 사실 정말 배칭을 해주는 (드로우 콜이 줄어드는) 기능은 아니다.</li>\n<li>드로우 콜이 발생할 때 렌더 스테이트를 올리는 비용을 재사용을 통해 줄여주어 사실상 배칭과 거의 비슷한 퍼포먼스를 내게 해준다.</li>\n<li>CPU Instancing과 퍼포먼스 비교시, GPU Instancing이 미세한 차이로 조금 빠르기는 하나, GPU Instancing은 메시가 동일해야하지만, SRP Batcher는 메시가 틀려도 사용 가능하기 때문에 SRP Batcher 판정승</li>\n</ul>\n<p><strong>URP는 확실히 좋다! 그치만…!</strong></p>\n<ul>\n<li>확실히 빨라집니다. (레거시 때 10프레임 나오던 프로젝트가 URP 전환 후 50프레임이 되기도)</li>\n<li>하지만 기존에 했던 방식과 호환이 안되고, 새로운 방식을 학습해야하는 문제가 있다.</li>\n<li>셰이더 그래프라는 ‘손쉽게’ 셰이더를 작성할 수 있는 도구도 있음.</li>\n</ul>\n<p><strong>그렇게 만져본 셰이더 그래프</strong></p>\n<ul>\n<li>UX는 좀 불~편</li>\n<li>단축키도 없고, 그룹 안에서 노드 생성 불가능하고, 컴포넌트 마스크도 없고, UV는 무조건 float4고… 등등등</li>\n<li>근데 컬링이 없어서 코드로 생성하고 바꿔줘야 한다…?</li>\n<li>어라…? 블렌드 모드를 넣을 수도 없다…?</li>\n<li>당연히 Zwrite, Ztest, 스텐실 등의 옵션도 사용하지 못한다…?</li>\n<li>그리고 노드 크기가 너무 크다…</li>\n</ul>\n<p><strong>그 외 불편했던 점들…</strong></p>\n<ul>\n<li>Unlit Master는 Receive Shadow가 안먹고 Ambient도 안먹고 심지어 Fog 까지 안먹는다.</li>\n<li>아마도 이펙트 등에 사용하라고 이렇게 만든 것이겠지만 모든 사물을 굳이 PBR로만 만들어야 하다니…?</li>\n<li>PBR이 아닌 Stylized 스타일에서도 라이트 연산하려면 굳이 무거운 PBR 연산을 해야한단 말인가..?</li>\n<li>PBR Master는 그림자 색도 맘대로 못바꿈. 디퓨즈 라이팅 계산도 변경 불가</li>\n<li>NPR 프로젝트에서는 명암이 셀셰이드처럼 나와야 하기 때문에 PBR보다는 Unlit방식으로 작업을 해야함</li>\n<li>이렇게 Unlit이지만 Light Vector도 알고싶고, Shadow도 받고 싶고, Fog도 적용되게 하고싶을 때 어떻게 해야하나</li>\n<li>셰이더 그래프에서 Custom Node를 활용하면 라이트벡터와 섀도우는 어찌저찌 해결이 되기는 함. 하지만 이거나 코딩이나…</li>\n<li>Header, Space 등의 어트리뷰트도 넣을 수 없어서 머티리얼 창 가독성이 굉장히 떨어짐</li>\n<li>생성한 코드 또한 가독성이 무척 떨어짐. 자동으로 생성된 괴로운 변수명들</li>\n<li>텍스쳐 uv Tiling Offset 기본 [No ScaleOffset]으로 되어있음…?</li>\n<li>뎁스페이드를 Transparent로 사용할 때만 제대로 나옴</li>\n<li>그 외에 버텍스 셰이더 계산인지 픽셀 셰이더 계산인지 헷갈려 하는 상황이 발생하거나…</li>\n<li>레거시 방식에서 구현한 함수 등을 복붙하기 넘 괴로움…</li>\n<li>테셀레이션, 지오메트리 셰이더 사용 불가</li>\n<li>그리고 무엇보다 가장 중요한 글로벌 키워드 멀티컴파일이 동작하지 않는다!</li>\n</ul>\n<p><strong>셰이더 그래프의 좋은점도 있습니다</strong></p>\n<ul>\n<li>서브그래프 생성시 자동으로 변수들 만들어 주는 것도 괜찮고</li>\n<li>멀티컴파일, 키워드이넘 등 만들기 편하고</li>\n<li>float4를 float3에 연결했을 때 다이나믹하게 float3으로 연결</li>\n<li>웹상에 자료가 많은 편</li>\n<li>어 음… 더 있었던 것 같은데 기억이 나지 않는군요! 생각나진 않아도 더 있을 것 같습니다!</li>\n</ul>\n<p><strong>앞서 언급했던 문제들을 해결하려면..</strong></p>\n<ul>\n<li>그것은 바로 코딩으로 셰이더를 작성하는 것.</li>\n<li>HLSL 방식이라고는 하지만 Legacy에서 프레그먼트 셰이더를 작성해봤다면 생각보다 어렵지 않습니다!</li>\n<li>한편 서피스 방식 사용자에게는 슬픈 일이지만 몇 가지 신경써야 할 부분들이 있습니다.</li>\n<li>가장 큰 부분이 행렬. 서피스 방식은 행렬을 자동으로 계산해주었지만, 이제는 직접 해야한다.</li>\n<li>하지만 두려울 것은 없다. 그냥 코드 한줄 넣어주면 되기 때문. 일단 외워서라도 해 볼만 합니다</li>\n<li>버텍스 인풋 아웃풋에 조금 더 신경을 써주고, 버텍스 셰이더에서 각 데이터들에 값을 정확하게 잘 넣어주는 것이 중요</li>\n</ul>\n<p><strong>서피스, 프레그먼트 방식과 URP의 다른점</strong></p>\n<ol>\n<li>인클루드 파일이 <em>UnityCG.cginc</em> 하나에 다 들어있는 것이 아니라 여러가지 파일로 나뉘어져 있습니다.</li>\n<li>예전에는 베이스패스 하나만 작성하면 되었지만, HLSL에서는 섀도우캐스터, 뎁스온리 등 다른 패스도 작성해야 합니다.</li>\n<li>행렬 이름이 달라졌습니다 (이제 unity…로 시작하는 행렬 이름을 보지 않아도 된다!)</li>\n<li>텍스쳐 샘플링 코드가 달라졌습니다.</li>\n<li>CBUFFER라는 것이 생겼습니다.</li>\n<li>라이트를 여러 개 사용할 수 있고, 라이트 관련 코드가 많이 바뀌었습니다.  등 등…</li>\n</ol>\n<p><strong>1. 인클루드 파일 / Include</strong></p>\n<ul>\n<li><em>Lighting.hlsl</em> - 라이트 구조체, 디퓨즈, 스펙큘러 계산, GI (SH, 라이트맵)</li>\n<li><em>Shadows.hlsl</em> - 섀도우맵 샘플링, 케스케이드 계산, ShadowCoord 계산, Shadow Bias 계산 등</li>\n<li><em>Core.hlsl</em> - 버텍스 인풋 구조체 정의, 스크린 UV계산, 포그계산 등</li>\n<li><em>Common.hlsl</em> - 각종 수학관련 구현, 텍스쳐 유틸리티, 뎁스 계산 등</li>\n<li><em>SpaceTransforms.hlsl</em> - 각종 공간변환 행렬 정의, Tangent ↔ World 행렬이 추가되었음</li>\n<li><em>EntityLighting.hlsl</em> - SH, ProveVolume, Lightmap 계산 등</li>\n<li><em>ImageBasedLighting</em> - PBR에서 IBL 관련 부분만 떨어진 것. GGX, Anisotropy, ImportanceSample 등</li>\n</ul>\n<p>　</p>\n<div style=\"margin-top: -60px;\"></div>\n<ul>\n<li>Leagacy - <em>UniryCG.cginc</em> 안에 각종 계산, 행렬, 라이트, 뎁스, 포그, 패럴렉스 등 함수들이 모여 있습니다.</li>\n<li>URP - <em>Lighting.hlsl, Shadows.hlsl, Common.hlsl, SpaceTransforms.hlsl, Core.hlsl, EntityLighting.hlsl</em> 등 코드가 기능별로 분리되어 있습니다.</li>\n</ul>\n<p><strong>2. 패스 / Pass</strong></p>\n<ul>\n<li>Legacy - 섀도우 캐스터나 뎁스 등은 자동 생성되는 방식\n<ul>\n<li>멀티패스, 그랩패스 등에 대해서도 딱히 제약 없었습니다.</li>\n</ul>\n</li>\n<li>URP - 섀도우, 뎁스 패스는 물론이고 때론 meta, universal 2D 패스 등도 작성해 주어야 합니다.\n<ul>\n<li>하지만 크게 어렵지는 않습니다. 포지션만 잘 맞춰서 보내주면 됩니다.</li>\n</ul>\n</li>\n<li>그랩패스 같은거 하려면 복잡 - 불투명한 것만 가져오려면 CameraOpaqueTexture를 이용하면 되지만, 캡쳐 렌더타겟을 바꾸고 싶다면 c#을 이용하여 새로운 렌더타겟에 그릴 렌더패스를 작성해야 합니다.</li>\n</ul>\n<p><strong>3. 행렬 / Matrix</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"hlsl\"><pre class=\"language-hlsl\"><code class=\"language-hlsl\"><span class=\"token comment\">// Fragment</span>\no<span class=\"token punctuation\">.</span>vertex <span class=\"token operator\">=</span> <span class=\"token function\">UnityObjectToClipPos</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">.</span>vertex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// URP HLSL</span>\no<span class=\"token punctuation\">.</span>vertex <span class=\"token operator\">=</span> <span class=\"token function\">TransformObjectToHClip</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">.</span>vertex<span class=\"token punctuation\">.</span>xyz<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>서피스 방식으로 작업해 오던 사람에게는 좀 어려울 수도 있는 부분 (서피스는 행렬을 안써도 셰이더 작성이 가능)</li>\n<li>일단은 행렬을 원리부터 이해하려고 하지 말고 쉽게 접근해 봅시다.</li>\n<li>행렬은 쉽게 말하면 이동, 회전, 스케일을 해 주는 계산을 말합니다.</li>\n<li>그런데 그냥 이동 회전 스케일을 해주는 것이 아니라 이 계산을 통하여 중심축을 이동 회전 스케일 해준다고 생각하면 됩니다. 그렇게 중심이 바뀌면 ‘공간’을 ‘변환’했다고 말합니다 ( ex : 로컬공간 → 월드공간, 월드공간 → 뷰 공간 )</li>\n<li>로컬공간에 있는 오브젝트는 월드, 뷰 를 거쳐 클립공간에 이르게 됩니다.</li>\n<li>클립공간으로 변환해주는 행렬을 보면 기존과 방식이 달라졌음을 알 수 있습니다.</li>\n<li>Unity…로 시작하던 행렬들이 Transform…로 바뀐 점은 대단히 직관적이어서 확실히 좋은 점입니다.</li>\n</ul>\n<p><strong>4. 샘플링 / Sampling</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"hlsl\"><pre class=\"language-hlsl\"><code class=\"language-hlsl\"><span class=\"token comment\">// UnityCG</span>\n<span class=\"token keyword\">half4</span> c <span class=\"token operator\">=</span> <span class=\"token function\">tex2D</span><span class=\"token punctuation\">(</span>_MainTex<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">.</span>texcoord<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// URP HLSL</span>\n<span class=\"token keyword\">float4</span> c <span class=\"token operator\">=</span> <span class=\"token function\">SMAPLE_TEXTURE2D</span><span class=\"token punctuation\">(</span>_MainTex<span class=\"token punctuation\">,</span> sampler_MainTex<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">.</span>texcoord<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>텍스쳐, 큐브맵등을 샘플링하는 코드가 달라졌습니다.</li>\n<li>Sampler를 표시해주는 등 HLSL 표준 방식으로 변환 (그래도 샘플러 정의를 해 주는 부분은 없어서 좋음)</li>\n<li>예전보다 직관적인 것 같기도 한데, 타이핑 할 코드가 많아진 부분은 <del>조금</del> 불만</li>\n<li><code class=\"language-text\">tex2D(Texture Object, uv)</code> → <code class=\"language-text\">SAMPLE_TEXTURE2D(Texture Object, Sampler, uv)</code></li>\n<li><code class=\"language-text\">texCUBElod(Cubemap Object, float4(Reflection Vector, mipLevel))</code> → <code class=\"language-text\">SAMPLER_TEXCUBE_LOD(Cubemap Object, Sampler, Reflection Vector, mipLevel)</code></li>\n</ul>\n<p><strong>5. CBUFFER</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"hlsl\"><pre class=\"language-hlsl\"><code class=\"language-hlsl\"><span class=\"token comment\">// UnityCG</span>\nsampler2D _MainTex<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">float4</span> _MainTex_ST<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">float4</span> _Color<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// URP HLSL</span>\n<span class=\"token function\">CBUFFER_START</span><span class=\"token punctuation\">(</span>UnityPerMaterial<span class=\"token punctuation\">)</span>\n\n<span class=\"token function\">TEXTURE2D</span><span class=\"token punctuation\">(</span>_MainTex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">SAMPLER</span><span class=\"token punctuation\">(</span>sampler_MainTex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">float4</span> _MainTex_ST<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">half4</span> _Color<span class=\"token punctuation\">;</span>\n\nCBUFFER_END</code></pre></div>\n<ul>\n<li>그냥 CBUFFER로 변수들을 감싸주면 끝</li>\n<li>CBUFFER로 감싼 변수들은 GPU 메모리 상에 업로드되어 SRP Batcher 계산을 위한 데이터로 쓰입니다.</li>\n<li>혹시 SRP Batcher를 사용하지 않고 GPU Instancing을 사용하고 싶다면 CBUFFER라고 쓰인 부분을 지워주면 됩니다.</li>\n<li>CBUFFER를 적어주면 SRP Batcher가 GPU Instancing보다 우선순위가 높기 때문에 SRP Batcher만 돌게 됩니다.</li>\n</ul>\n<p><strong>6. 라이트 / Light</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"hlsl\"><pre class=\"language-hlsl\"><code class=\"language-hlsl\"><span class=\"token comment\">// UnityCG</span>\n<span class=\"token keyword\">half3</span> worldSpaceLightDir <span class=\"token operator\">=</span> <span class=\"token function\">normalize</span><span class=\"token punctuation\">(</span>_WorldSpaceLightPos0<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// URP HLSL</span>\nLight mainLight <span class=\"token operator\">=</span> <span class=\"token function\">GetMainLight</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">.</span>shadowCoord<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>라이트 관련 처리가 가장 많이 바뀌었습니다.</li>\n<li>기존에는 1패스 당 1라이트 방식이었는데, 이제 1패스에 16개까지의 라이트를 한 번에 연산합니다.</li>\n<li>디렉션만 따로 받아올 수도 있지만, 구조체 방식으로 받아오는 것이 생각보다 코드 작성에 좋습니다.</li>\n<li>라이트 관련 처리가 바뀌면서 그림자에 대한 부분도 함께 바뀌었습니다.</li>\n<li>이 부분은 특히 가장 중요한 부분이니 후에 픽셀셰이더를 다룰 때 더 자세히 다루도록 하겠습니다.</li>\n</ul>\n<hr>\n<h3 id=\"셰이더-제작\" style=\"position:relative;\"><a href=\"#%EC%85%B0%EC%9D%B4%EB%8D%94-%EC%A0%9C%EC%9E%91\" aria-label=\"셰이더 제작 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>셰이더 제작</h3>\n<p>자 그럼, 처음부터 하나하나 짚어가면서 CustomLighting 셰이더를 만들어봅시다</p>\n<p><strong>간단 렌더링 파이프라인</strong></p>\n<div style=\"width: 100%; height: 100%; display: flex; flex-direction: row; gap: 10px;\">\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 550px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 82.22222222222221%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC+ElEQVQozzWSS3PbNhSF9eu77jarZiabNDNZNBM7aUZxnDSt5Ui2zIdEUXwTJEWA7xcAggSQkeLe+bbnnjP3nkXeTGU7OwnWHaTZ5aNZHCNC8Cy44PMZMcuellkNEuSleZDmASzClkApxUJeRveaq2/Gu+X2052t2lWbY9yOFyjppiyPg8g2TM3xDo5nuoFVdEBIvhBS8mnukyg2DVt5SCyzBaBNW9Ix3Iy4obSdEIpQHlV15vlHhOKqRlntX5y5ZO0cHSpj7a++KMbaD3ZF4Xc4Jz3CfYZxPp4iH/h2HARHYxe4Thz6aWpzOi/kKHBHzWOlKNH9D8+0yjBkJSIUMzIwMowj5rAM4syGJbB8PYIuqkLY21PPFpLKrm4O3fhRd/64/vzZBPuGlbAnDcVnCG0nmPku2Ku7B8vZmY5+dHU02PPAFoIKMmAnLbdWdLvZ2aiLa8bYzIU4w7kUsqRB1CpxswsrNWr0uNXRaMz9tBAjZ60w1EZ/SDZ3gbaJ9YcCen2f4w7hLsekYHFsRYkF09A01ShyEQyTfDd17PyqGU+ZkzpPlnK3dVQb2fGAeo753E+0JqSaktT0oqcwPuyPay/UQWJEuSJmfhYLzqe26nLoHo3QMsIAqfvTVg+2OgApGbEA0PQTM0Xx7qD4wDkhAGpVSv5ckokLOrInRXNsVwvwPypcrpybDdB8TDseJHsPPp4q8wg2fqrG5R60j89iIeWTN/z11Xp9vb3619uFVAjxa6kQXHKZjweXffDZ0qV/e+PSY59ithJCPMeuYRbanqHowAnKBOEGTyOnA6uznvbch4qbaGmW7EzFj+wkC71i878z56wqChD4ez0HAcmyNutxN5J+7BuCmzk4Kc76rfbxtb78c/3+lXnzBlXf+Vl8SbjSwLsb/c3V6v0X/V5Lm5wMDcXtWJ7aLpss/x5tXoYfXvz36jft7e/V95cneM2lfD4YKgmAfZwNAPWwpNM4i18tuawu+gDA2+T0LYxvo+RrnN7CRhFS/gRmI2SgxpAQaAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"RenderPipeline01\"\n        title=\"RenderPipeline01\"\n        src=\"/static/9313cb56a25739b1e3b7628b868c3d2e/dd45a/URP_img003.png\"\n        srcset=\"/static/9313cb56a25739b1e3b7628b868c3d2e/e9ff0/URP_img003.png 180w,\n/static/9313cb56a25739b1e3b7628b868c3d2e/f21e7/URP_img003.png 360w,\n/static/9313cb56a25739b1e3b7628b868c3d2e/dd45a/URP_img003.png 550w\"\n        sizes=\"(max-width: 550px) 100vw, 550px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 32.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABYUlEQVQY012Puy9DYRyGv+87PU30nAqpu+jN4eSURLXaUqJhcVlEiGojGEwszI2I/8FgsEh0EJeBwWQUsQmJySJhMhtMj7R1H558b773zZP8hJCCkBPAjlo4cRtfYy1CCDQpUFKUc+nPiXdiRzsIR4JoSqJEpVe/dmU03cXx3S5Xryfcvl8wvzH7WapPBNn1aW7ejrh83ufwfgehu38E/5FKEelrZ3RukvTUCImuJjL+KoaDJsNBg4zfQ7K7ieR4irHlLNF+i6Ggl0zAqGwCBiMhk3pT/5LKcvA2WFT3TLPS4+VlM8Z9YZC7QpqXzV5WEz4MZ4JYdovm1g6u1xwet4d4KAzwUEjxtJVg3DK+hAKpJLpLQ3h8zHTXcLYU5iBncbBgc74YJt/XjOYLYNa10NIWYm82xOFShGIuTDFvcbpsM+D3/Ah/o2sSr1thltBLWUNXfzeGWyt3plt+vy5VufQDBdy0KyRW1ugAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"RenderPipeline01\"\n        title=\"RenderPipeline01\"\n        src=\"/static/7715d9caabac0bce16def13154271295/37523/URP_img004.png\"\n        srcset=\"/static/7715d9caabac0bce16def13154271295/e9ff0/URP_img004.png 180w,\n/static/7715d9caabac0bce16def13154271295/f21e7/URP_img004.png 360w,\n/static/7715d9caabac0bce16def13154271295/37523/URP_img004.png 720w,\n/static/7715d9caabac0bce16def13154271295/302a4/URP_img004.png 1080w,\n/static/7715d9caabac0bce16def13154271295/6d74e/URP_img004.png 1085w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n</div>\n<ul>\n<li>DX11까지의 렌더링 파이프라인은 좌측과 같으나, 이걸 다 다루면 상당한 시간이 걸립니다.</li>\n<li>셰이더를 만들때는 오른쪽과 같은 느낌으로 간단하게 생각해주세요</li>\n<li>appdata 는 버텍스 인풋이라고도 불리고, v2f 는 버텍스 아웃풋이라고도 불립니다</li>\n<li>서피스 함수에서 Input이라고 불렸던 구조체는 버텍스 아웃풋과 동일한 구조체입니다</li>\n</ul>\n<p><strong>셰이더 명, 프로퍼티, 각종태그</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"hlsl\"><pre class=\"language-hlsl\"><code class=\"language-hlsl\">Shader <span class=\"token string\">\"CustomLighting/Master\"</span>\n<span class=\"token punctuation\">{</span>\n\t\tProperties\n\t\t<span class=\"token punctuation\">{</span>\n\t\t\t\t<span class=\"token function\">_Color</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"Color\"</span><span class=\"token punctuation\">,</span> Color<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\t\t\t\t<span class=\"token function\">_MainTex</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"BaseColor Texture\"</span><span class=\"token punctuation\">,</span> 2D<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"white\"</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t\n\t\t<span class=\"token punctuation\">.</span>\n\t\t<span class=\"token punctuation\">.</span>\n\t\t<span class=\"token punctuation\">.</span>\n\n\t\tSubShader\n\t\t<span class=\"token punctuation\">{</span>\n\t\t\t\tTags\n\t\t\t\t<span class=\"token punctuation\">{</span>\n\t\t\t\t\t\t<span class=\"token string\">\"RenderPipeline\"</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"UniversalPipeline\"</span>\n\t\t\t\t\t\t<span class=\"token string\">\"RenderType\"</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"Opaque\"</span>\n\t\t\t\t\t\t<span class=\"token string\">\"Queue\"</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"Geometry+0\"</span>\n\t\t\t\t<span class=\"token punctuation\">}</span>\n\t\t\t\tLOD <span class=\"token number\">100</span>\n\n\t\t\t\t<span class=\"token punctuation\">.</span>\n\t\t\t\t<span class=\"token punctuation\">.</span>\n\t\t\t\t<span class=\"token punctuation\">.</span>\n\t\t\t\n\t\t\t\tPass\n\t\t\t\t<span class=\"token punctuation\">{</span>\n\t\t\t\t\t\tName <span class=\"token string\">\"Universal Forward\"</span>\n\t\t\t\t\t\tTags\n\t\t\t\t\t\t<span class=\"token punctuation\">{</span>\n\t\t\t\t\t\t\t\t<span class=\"token string\">\"LightMode\"</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"UniversalForward\"</span>\n\t\t\t\t\t\t<span class=\"token punctuation\">}</span>\n\t\t\t\t\t\tCull Back\n\n\t\t\t\t<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></code></pre></div>\n<ul>\n<li>여기는 기존 Legacy 방식과 거의 비슷합니다</li>\n<li><code class=\"language-text\">[Header]</code>, <code class=\"language-text\">[Space()]</code>, <code class=\"language-text\">(Enum.UnityEngine.Rendering.BlendMode)</code>등 기존 어트리뷰트 동일하게 사용가능</li>\n<li>태그 렌더 파이프라인에 <code class=\"language-text\">UniversalPipeline</code>이라고 넣어주고, Pass 안에서는 LightMode를 정의해줍니다</li>\n<li>컬링, 블랜드모드, Zwrite, Ztest 등도 모두 여기에서 기존과 동일한 방식으로 입력 가능</li>\n<li>라이트 모드는 기존 ForwardBase에서 UniversalForward로 바뀌었습니다 (Forward Add는 이제 없습니다)</li>\n</ul>\n<p><strong>멀티 컴파일, 인클루드</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"hlsl\"><pre class=\"language-hlsl\"><code class=\"language-hlsl\">HLSLPROGRAM\n\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">pragma</span> <span class=\"token expression\">prefer_hlslcc gles</span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">pragma</span> <span class=\"token expression\">exclude_renderers d3d11_9x</span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">pragma</span> <span class=\"token expression\">vertex vert</span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">pragma</span> <span class=\"token expression\">fragment frag</span></span>\n\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"Packages/com.unity.render-pipelines.universal/ShaderLibrary/Lighting.hlsl\"</span></span>\n\n<span class=\"token comment\">// GPU Instancing</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">pragma</span> <span class=\"token expression\">multi_compile_instancing</span></span>\n\n<span class=\"token comment\">// Fog</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">pragma</span> <span class=\"token expression\">multi_compile_fog</span></span>\n\n<span class=\"token comment\">// Light &amp; Shadow</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">pragma</span> <span class=\"token expression\">multi_compile _ _MAIN_LIGHT_SHADOWS</span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">pragma</span> <span class=\"token expression\">multi_compile _ _MAIN_LIGHT_SHADOWS_CASCADE</span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">pragma</span> <span class=\"token expression\">multi_compile _ _ADDITIONAL_LIGHTS</span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">pragma</span> <span class=\"token expression\">multi_compile _ _ADDITIONAL_LIGHT_SHADOWS</span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">pragma</span> <span class=\"token expression\">multi_compile _ _SHADOWS_SOFT</span></span>\n\n<span class=\"token comment\">// lightmap</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">pragma</span> <span class=\"token expression\">multi_compile _ DIRLIGHTMAP_COMBINED</span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">pragma</span> <span class=\"token expression\">multi_compile _ LIGHTMAP_ON</span></span></code></pre></div>\n<ul>\n<li>GPU Instancing은 SRP Batcher를 사용할 것이라면 빼도 무방합니다</li>\n<li>라이트를 하나만 사용할 거면 <code class=\"language-text\">_ADDITIONAL_LIGHTS</code> 키워드도 사용하지 않아도 됩니다.</li>\n<li>하드라이트만 사용할 거라면 <code class=\"language-text\">_SHADOWS_SOFT</code> 키워드를 빼도 됩니다</li>\n<li>라이트 맵을 사용할 거라면 <code class=\"language-text\">LIGHTMAP_ON</code> 키워드를 추가해주세요</li>\n<li><em>Lighting.hlsl</em> 은 완전 unlit을 할게 아니라면 거의 사용하게 될 주요 hlsl입니다.</li>\n</ul>\n<p><strong>CBUFFER, Vertex Input, Vertex Output</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"hlsl\"><pre class=\"language-hlsl\"><code class=\"language-hlsl\"><span class=\"token function\">CBUFFER_START</span> <span class=\"token punctuation\">(</span>UnityPerMaterial<span class=\"token punctuation\">)</span>\n\n<span class=\"token function\">TEXURE2D</span><span class=\"token punctuation\">(</span>_MainTex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">SAMPLER</span><span class=\"token punctuation\">(</span>sampler_MainTex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">float4</span> _MainTex_ST<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">half4</span> _Color<span class=\"token punctuation\">;</span>\n\nCBUFFER_END\n\n<span class=\"token keyword\">struct</span> <span class=\"token class-name\">appdata</span>\n<span class=\"token punctuation\">{</span>\n\t\t<span class=\"token keyword\">float4</span> vertex <span class=\"token operator\">:</span> POSITION<span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">float2</span> texcoord <span class=\"token operator\">:</span> TEXCOORD0<span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">float3</span> normal <span class=\"token operator\">:</span> NORMAL<span class=\"token punctuation\">;</span>\n\t\tUNITY_VERTEX_INPUT_INSTANCE_ID\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">struct</span> <span class=\"token class-name\">v2f</span>\n<span class=\"token punctuation\">{</span>\n\t\t<span class=\"token keyword\">float4</span> vertex <span class=\"token operator\">:</span> SV_POSITION<span class=\"token punctuation\">;</span>         <span class=\"token comment\">// vertex : 버텍스 포지션 (필수)</span>\n\t\t<span class=\"token keyword\">float3</span> normal <span class=\"token operator\">:</span> NORMAL<span class=\"token punctuation\">;</span>              <span class=\"token comment\">// normal : 라이팅 계산 해야하면 추가</span>\n\t\t<span class=\"token keyword\">float2</span> texcoord <span class=\"token operator\">:</span> TEXCOORD0<span class=\"token punctuation\">;</span>         <span class=\"token comment\">// texcoord : 텍스쳐 넣을거면 추가</span>\n\t\t<span class=\"token keyword\">float</span> fogCoord <span class=\"token operator\">:</span> TEXCOORD1<span class=\"token punctuation\">;</span>          <span class=\"token comment\">// fogDoord : 포그 넣을거면 추가</span>\n\t\t<span class=\"token keyword\">float4</span> shadowCoord <span class=\"token operator\">:</span> TEXCOORD2<span class=\"token punctuation\">;</span>      <span class=\"token comment\">// shadowCoord : 실시간 그림자 맵 사용할거면 추가</span>\n\t\t<span class=\"token keyword\">float3</span> worldPos <span class=\"token operator\">:</span> TEXCOORD3<span class=\"token punctuation\">;</span>         <span class=\"token comment\">// worldPos : 뭔가 월드에서 포지션 계산할 일이 있으면 추가</span>\n\t\tUNITY_VERTEX_INPUT_INSTANCE_ID       <span class=\"token comment\">// GPU 인스턴싱 할거면 추가</span>\n\t\tUNITY_VERTEX_OUTPUT_STEREO           <span class=\"token comment\">// VR에서 사용할 셰이더라면 추가</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>프로퍼티 변수들은 무조건 <em>CBUFFER</em> 로 감싸줍니다</li>\n<li>GPU 인스턴싱을 사용하지 않을 거면 <code class=\"language-text\">UNITY_VERTEX_INPUT_INSTANCE_ID</code>는 없어도 됩니다</li>\n<li>VR을 사용하지 않는다면 <code class=\"language-text\">UNITY_VERTEX_OUTPUT_STEREO</code>는 없어도 됩니다</li>\n<li>포그를 사용하지 않는다면 <code class=\"language-text\">fogCoord</code>가 없어도 되고</li>\n<li>그림자를 생성하지 않는다면 <code class=\"language-text\">shadowCoord</code>가 없어도 되고</li>\n<li>라이트를 여러 개 사용하지 않는다면 worldPos가 없어도 됩니다 (만 WorldPos는 다른데에 사용할일이 많긴 합니다)</li>\n<li>v2f라는 구조체 이름은 <em>vertex to fragment</em>라는 뜻 입니다</li>\n<li>이 값들에 대한 자세한 내용은 버텍스 셰이더를 보면 나옵니다.</li>\n<li>예전에는 <code class=\"language-text\">appdata_tan</code>, <code class=\"language-text\">appdata_full</code>등의 미리 지정된 구조체들이 있었지만, 이제는 잊으세요!</li>\n</ul>\n<p><strong>버텍스 셰이더</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"hlsl\"><pre class=\"language-hlsl\"><code class=\"language-hlsl\">v2f <span class=\"token function\">vert</span> <span class=\"token punctuation\">(</span>appdata v<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n\t\tv2f o<span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">UNITY_SETUP_INSTANCE_ID</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">UNITY_TRANSFER_INSTANCE_ID</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">,</span> o<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\n\t\to<span class=\"token punctuation\">.</span>vertex <span class=\"token operator\">=</span> <span class=\"token function\">TransformObjectToHClip</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">.</span>vertex<span class=\"token punctuation\">.</span>xyz<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>           <span class=\"token comment\">// vertex : 버텍스 클립포지션은 무조건 필요합니다</span>\n\t\to<span class=\"token punctuation\">.</span>texcoord <span class=\"token operator\">=</span> <span class=\"token function\">TRANSFORM_TEX</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">.</span>texcoord<span class=\"token punctuation\">,</span> _MainTex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>          <span class=\"token comment\">// texcoord : texcoord는 일반적으로 uv라 부르는 텍스쳐 샘플링 좌표입니다. TRANSFORM_TEX 함수로 _MainTex_ST와 연결시켜줍니다. ST는 Scale Translate의 약자입니다</span>\n\t\to<span class=\"token punctuation\">.</span>normal <span class=\"token operator\">=</span> <span class=\"token function\">TransformObjectToWorldNormal</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">.</span>normal<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>         <span class=\"token comment\">// normal : 오브젝트 노멀을 월드노멀로 변환해줍니다. 라이팅연산을 안할거면 해당 코드를 지워도 됩니다</span>\n\t\to<span class=\"token punctuation\">.</span>fogCoord <span class=\"token operator\">=</span> <span class=\"token function\">ComputeFogFactor</span><span class=\"token punctuation\">(</span>o<span class=\"token punctuation\">.</span>vertex<span class=\"token punctuation\">.</span>z<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>                 <span class=\"token comment\">// fogCoord : 클립포지션의 z값을 기반으로 어느정도 포그가 적용되어야 할지에 대한 값을 구합니다</span>\n\t\to<span class=\"token punctuation\">.</span>worldPos <span class=\"token operator\">=</span> <span class=\"token function\">TransformObjectToWorld</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">.</span>vertex<span class=\"token punctuation\">.</span>xyz<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>         <span class=\"token comment\">// worldPos : 뭔가 월드에서 계산할일이 있으면 추가 (라이트 계산등은 주로 월드에서 합니다)</span>\n\t\to<span class=\"token punctuation\">.</span>shadowCoord <span class=\"token operator\">=</span> <span class=\"token function\">TrnasformWorldToShadowCoord</span><span class=\"token punctuation\">(</span>o<span class=\"token punctuation\">.</span>worldPos<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>   <span class=\"token comment\">// shadowCoord : 그림자 맵의 좌표를 구합니다</span>\n\n\t\t<span class=\"token keyword\">return</span> o<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>각 버텍스 아웃풋 데이터들이 거의 하나의 함수로 간단하게 계산되고 있는 것을 볼 수 있습니다</li>\n</ul>\n<p><strong>공간변환</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"hlsl\"><pre class=\"language-hlsl\"><code class=\"language-hlsl\">o<span class=\"token punctuation\">.</span>vertex <span class=\"token operator\">=</span> <span class=\"token function\">TransformObjectToHClip</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">.</span>vertex<span class=\"token punctuation\">.</span>xyz<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\no<span class=\"token punctuation\">.</span>normal <span class=\"token operator\">=</span> <span class=\"token function\">TransformObjectToWorldNormal</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">.</span>normal<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\no<span class=\"token punctuation\">.</span>worldPos <span class=\"token operator\">=</span> <span class=\"token function\">TransformObjectToWorld</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">.</span>vertex<span class=\"token punctuation\">.</span>xyz<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"hlsl\"><pre class=\"language-hlsl\"><code class=\"language-hlsl\"><span class=\"token comment\">// SpaceTransforms.hlsl</span>\n<span class=\"token keyword\">float4</span> <span class=\"token function\">TransformWorldToHClip</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">float3</span> positionWS<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n\t\t<span class=\"token keyword\">return</span> <span class=\"token function\">mul</span><span class=\"token punctuation\">(</span><span class=\"token function\">GetWorldToHClipMatrix</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">float4</span><span class=\"token punctuation\">(</span>positionWS<span class=\"token punctuation\">,</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">float3</span> <span class=\"token function\">TransformObjectToWorldNormal</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">float3</span> normalOS<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">ifdef</span> <span class=\"token expression\">UNITY_ASSUME_UNIFORM_SCALING</span></span>\n\t\t<span class=\"token keyword\">return</span> <span class=\"token function\">TransformObjectToWorldDir</span><span class=\"token punctuation\">(</span>normalOS<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">else</span></span>\n\t\t<span class=\"token comment\">// Normal need to be multiply by inverse transpose</span>\n\t\t<span class=\"token keyword\">return</span> <span class=\"token function\">SafeNormalize</span><span class=\"token punctuation\">(</span><span class=\"token function\">mul</span><span class=\"token punctuation\">(</span>normalOS<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">float3x3</span><span class=\"token punctuation\">)</span><span class=\"token function\">GetWorldToObjectMatrix</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">float3</span> <span class=\"token function\">TransformObjectToWorld</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">float3</span> positionOS<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n\t\t<span class=\"token keyword\">return</span> <span class=\"token function\">mul</span><span class=\"token punctuation\">(</span><span class=\"token function\">GetObjectToWorldMatrix</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">float4</span><span class=\"token punctuation\">(</span>positionOS<span class=\"token punctuation\">,</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>xyz<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li><em>SpaceTransforms.hlsl</em> 을 열어봅시다</li>\n<li>유니티는 행렬과 벡터를 연산할 때 행렬 * 벡터 순으로 계산해야합니다</li>\n<li>다만 노멀의 경우 월드로 갈 때 Inverse Transpose (전치역행렬)을 곱해주어야 틀어지지 않은 제대로된 노멀값을 얻을 수 있으므로 순서를 바꿔줍니다</li>\n<li>회전행렬의 경우 곱하는 순서를 바꾸면 역행렬 계산을 할 수 있기 때문에 이것을 알아두면 공간변활할 때 굉장히 유용합니다</li>\n<li>행렬을 구하는 코드들을 보면 <code class=\"language-text\">UNITY_MATRIX_M</code> ← 이렇게 예전방식 행렬들을 그대로 사용하고 있는 것을 알 수 있습니다</li>\n</ul>\n<p><strong>텍스쳐 좌표</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"hlsl\"><pre class=\"language-hlsl\"><code class=\"language-hlsl\"><span class=\"token comment\">// vert()</span>\no<span class=\"token punctuation\">.</span>texcoord <span class=\"token operator\">=</span> <span class=\"token function\">TRANSFORM_TEX</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">.</span>texcoord<span class=\"token punctuation\">,</span> _MainTex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\no<span class=\"token punctuation\">.</span>texcoord <span class=\"token operator\">=</span> v<span class=\"token punctuation\">.</span>texcoord <span class=\"token operator\">*</span> _MainTex_ST<span class=\"token punctuation\">.</span>xy <span class=\"token operator\">+</span> _MainTex_ST<span class=\"token punctuation\">.</span>zw<span class=\"token punctuation\">;</span>   <span class=\"token comment\">// 윗줄 코드와 같다</span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">TRANSFORM_TEX</code>는 사실 <code class=\"language-text\">_MainTEX_ST</code>라는 변수의 xy값을 곱해서 스케일로 사용하고, zw를 더해서 옵셋으로 사용한 것을 간편한 함수로 표현한 것입니다</li>\n<li>여전히 레거시 방식 그대로 사용이 가능합니다</li>\n</ul>\n<p><strong>포그 좌표</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"hlsl\"><pre class=\"language-hlsl\"><code class=\"language-hlsl\"><span class=\"token comment\">// frag()</span>\no<span class=\"token punctuation\">.</span>fogCoord <span class=\"token operator\">=</span> <span class=\"token function\">ComputeFogFactor</span><span class=\"token punctuation\">(</span>o<span class=\"token punctuation\">.</span>vertex<span class=\"token punctuation\">.</span>z<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Core.hlsl</span>\nreal <span class=\"token function\">ComputeFogFactor</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">float</span> z<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n\t\t<span class=\"token keyword\">float</span> clupZ_01 <span class=\"token operator\">=</span> <span class=\"token function\">UNITY_Z_0_FAR_FROM_CLIPSAPCE</span><span class=\"token punctuation\">(</span>z<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">if</span> <span class=\"token expression\"><span class=\"token function\">defined</span><span class=\"token punctuation\">(</span>FOG_LINEAR<span class=\"token punctuation\">)</span></span></span>\n\t\t<span class=\"token comment\">// factor = (end-z)/(end-start) = z * (-1/(end-start)) + (end/(end-start))</span>\n\t\t<span class=\"token keyword\">float</span> fogFactor <span class=\"token operator\">=</span> <span class=\"token function\">saturate</span><span class=\"token punctuation\">(</span>clipZ_01 <span class=\"token operator\">*</span> unity_FogParams<span class=\"token punctuation\">.</span>z <span class=\"token operator\">+</span> unity_FogParams<span class=\"token punctuation\">.</span>w<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">return</span> <span class=\"token function\">real</span><span class=\"token punctuation\">(</span>fogFactor<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">elif</span> <span class=\"token expression\"><span class=\"token function\">defined</span><span class=\"token punctuation\">(</span>FOG_EXP<span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token function\">defined</span><span class=\"token punctuation\">(</span>FOG_EXP2<span class=\"token punctuation\">)</span></span></span>\n\t\t<span class=\"token comment\">// factor = exp(-(density*z)*2)</span>\n\t\t<span class=\"token comment\">// -density * z computed at vertex</span>\n\t\t<span class=\"token keyword\">return</span> <span class=\"token function\">real</span><span class=\"token punctuation\">(</span>unity_FogParams<span class=\"token punctuation\">.</span>x <span class=\"token operator\">*</span> clipZ_01<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">else</span></span>\n\t<span class=\"token keyword\">return</span> <span class=\"token number\">0.</span>0b<span class=\"token punctuation\">;</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li><em>Core.hlsl</em> 파일을 열어보면 포그좌표 구하는 공식을 볼 수 있습니다</li>\n<li>Linear, Exponential, Exponential Squared 방식에 따라 각각 계산방법이 정의되어 있습니다</li>\n<li>포그는 좌표만 구하면 픽셀 셰이더에서는 보간만 해주는 방식</li>\n<li>포그는 셰이더 그래프에 포그 노드가 있지만 Unlit Master에서는 <code class=\"language-text\">multi_compile_fog</code>가 없어서 작동하지 않습니다</li>\n<li>(PBR Master는 <code class=\"language-text\">multi_compile_fog</code> 키워드도 있고 Mixfog 계산도 다 되어있어서 포그노드 없이도 알아서 잘 작동)</li>\n</ul>\n<p><strong>그림자 좌표</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"hlsl\"><pre class=\"language-hlsl\"><code class=\"language-hlsl\"><span class=\"token comment\">// frag()</span>\nVertexPositionInputs vertexInput <span class=\"token operator\">=</span> <span class=\"token function\">GetVertexPositionInputs</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">.</span>vertex<span class=\"token punctuation\">.</span>xyz<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\no<span class=\"token punctuation\">.</span>shadowCoord <span class=\"token operator\">=</span> <span class=\"token function\">GetShadowCoord</span><span class=\"token punctuation\">(</span>vertexInput<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\no<span class=\"token punctuation\">.</span>shadowCoord <span class=\"token operator\">=</span> <span class=\"token function\">TransformWorldToShadowCoord</span><span class=\"token punctuation\">(</span>o<span class=\"token punctuation\">.</span>worldPos<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Core.hlsl</span>\nVertexPositionInputs <span class=\"token function\">GetVertexPositionInputs</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">float3</span> positionOS<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n\t\tVertexPositionInputs Input<span class=\"token punctuation\">;</span>\n\t\tInput<span class=\"token punctuation\">.</span>positionWS <span class=\"token operator\">=</span> <span class=\"token function\">TransformOjbectToWorld</span><span class=\"token punctuation\">(</span>positionOS<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tInput<span class=\"token punctuation\">.</span>positionVS <span class=\"token operator\">=</span> <span class=\"token function\">TransformWorldToView</span><span class=\"token punctuation\">(</span>Input<span class=\"token punctuation\">.</span>positionWS<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tInput<span class=\"token punctuation\">.</span>positionCS <span class=\"token operator\">=</span> <span class=\"token function\">TransformWorldToHClip</span><span class=\"token punctuation\">(</span>Input<span class=\"token punctuation\">.</span>positionWS<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t\t<span class=\"token keyword\">float4</span> ndc <span class=\"token operator\">=</span> Input<span class=\"token punctuation\">.</span>positionCS <span class=\"token operator\">*</span> <span class=\"token number\">0.5f</span><span class=\"token punctuation\">;</span>\n\t\tInput<span class=\"token punctuation\">.</span>positionNDC<span class=\"token punctuation\">.</span>xy <span class=\"token operator\">=</span> <span class=\"token keyword\">float2</span><span class=\"token punctuation\">(</span>ndc<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">,</span> ndc<span class=\"token punctuation\">.</span>y <span class=\"token operator\">*</span> _ProjectionParams<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> ndc<span class=\"token punctuation\">.</span>w<span class=\"token punctuation\">;</span>\n\t\tInput<span class=\"token punctuation\">.</span>positionNDC<span class=\"token punctuation\">.</span>zw <span class=\"token operator\">=</span> Input<span class=\"token punctuation\">.</span>positionCS<span class=\"token punctuation\">.</span>zw<span class=\"token punctuation\">;</span>\n\n\t\t<span class=\"token keyword\">return</span> Input<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// Shadows.hlsl</span>\n<span class=\"token keyword\">float4</span> <span class=\"token function\">GetShadowCoord</span><span class=\"token punctuation\">(</span>VertexPositionInputs vertexInput<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">if</span> <span class=\"token expression\">SHADOWS_SCREEN</span></span>\n\t\t<span class=\"token keyword\">return</span> <span class=\"token function\">ComputeScreenPos</span><span class=\"token punctuation\">(</span>vertexInput<span class=\"token punctuation\">.</span>positionCS<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">else</span></span>\n\t\t<span class=\"token keyword\">return</span> <span class=\"token function\">TransformWorldToShadowCoord</span><span class=\"token punctuation\">(</span>vertexInput<span class=\"token punctuation\">.</span>positionWS<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">float4</span> <span class=\"token function\">TransformWorldToShadowCoord</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">float3</span> positionWS<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">ifdef</span> <span class=\"token expression\">_MAIN_LIGHT_SHADOWS_CASCADE</span></span>\n\t\t<span class=\"token keyword\">half</span> cascadeIndex <span class=\"token operator\">=</span> <span class=\"token function\">ComputeCascadeIndex</span><span class=\"token punctuation\">(</span>positionWS<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">return</span> <span class=\"token function\">mul</span><span class=\"token punctuation\">(</span>_MainLightWorldToShadow<span class=\"token punctuation\">[</span>cascadeIndex<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">float4</span><span class=\"token punctuation\">(</span>position<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">else</span></span>\n\t\t<span class=\"token keyword\">return</span> <span class=\"token function\">mul</span><span class=\"token punctuation\">(</span>_MainLightWorldToShadow<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">float4</span><span class=\"token punctuation\">(</span>position<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li><em>Core.hlsl</em> 과 <em>Shadows.hlsl</em>을 보면 해당 코드가 있습니다</li>\n<li><code class=\"language-text\">ShadowCoord</code>를 구할 때 <code class=\"language-text\">VertexInput</code>을 넣어주는건 결국 <code class=\"language-text\">worldPosition</code>을 구하기 위함입니다</li>\n<li>각 공간의 포지션 값을 굳이 다 계산할 것 없이, <code class=\"language-text\">GetShadowCoord()</code>를 쓰지말고, 바로 <code class=\"language-text\">TransformWorldToShadowCoord()</code>를 사용하는 것도 좋은 방법입니다</li>\n</ul>\n<p><strong>프레그먼트 셰이더 / Fragment Shader</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"hlsl\"><pre class=\"language-hlsl\"><code class=\"language-hlsl\"><span class=\"token keyword\">half4</span> <span class=\"token function\">frag</span> <span class=\"token punctuation\">(</span>v2f i<span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> SV_Target\n<span class=\"token punctuation\">{</span>\n\t\t<span class=\"token function\">UNITY_SETUP_INSTANCE_ID</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t\t<span class=\"token comment\">// Get MainLight</span>\n\t\tLight mainLight <span class=\"token operator\">=</span> <span class=\"token function\">GetMainLight</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">.</span>shadowCoord<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\ti<span class=\"token punctuation\">.</span>normal <span class=\"token operator\">=</span> <span class=\"token function\">normalize</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">.</span>normal<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t\t<span class=\"token comment\">// Diffuse</span>\n\t\t<span class=\"token keyword\">float3</span> lambert <span class=\"token operator\">=</span> <span class=\"token function\">LightingLambert</span><span class=\"token punctuation\">(</span>mainLight<span class=\"token punctuation\">.</span>color<span class=\"token punctuation\">,</span> mainLight<span class=\"token punctuation\">.</span>direction<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">.</span>normal<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">float4</span> c <span class=\"token operator\">=</span> <span class=\"token function\">SAMPLE_TEXTURE2D</span><span class=\"token punctuation\">(</span>_MainTex<span class=\"token punctuation\">,</span> sampler_MainTex<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">.</span>texcoord<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> _Color<span class=\"token punctuation\">;</span>\n\n\t\t<span class=\"token comment\">// Specular</span>\n\t\t<span class=\"token keyword\">float3</span> specular <span class=\"token operator\">=</span> <span class=\"token function\">LightingSpecular</span><span class=\"token punctuation\">(</span>mainLight<span class=\"token punctuation\">.</span>color<span class=\"token punctuation\">,</span> mainLight<span class=\"token punctuation\">.</span>direction<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">.</span>normal<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">.</span>viewDir<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> _Gloss<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t\t<span class=\"token comment\">// GI</span>\n\t\t<span class=\"token keyword\">half3</span> ambient <span class=\"token operator\">=</span> <span class=\"token function\">SampleSH</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">.</span>normal<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t\t<span class=\"token comment\">// Combine</span>\n\t\tc<span class=\"token punctuation\">.</span>rgb <span class=\"token operator\">*=</span> lambert <span class=\"token operator\">*</span> mainLight<span class=\"token punctuation\">.</span>distanceAttenuation <span class=\"token operator\">*</span> mainLight<span class=\"token punctuation\">.</span>shadowAttenuation<span class=\"token punctuation\">;</span>\n\t\tc<span class=\"token punctuation\">.</span>rgb <span class=\"token operator\">+=</span> ambient <span class=\"token operator\">+</span> specular<span class=\"token punctuation\">;</span>\n\n\t\t<span class=\"token comment\">// Get Additional Light</span>\n\t\t<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">ifedf</span> <span class=\"token expression\">_ADDITIONAL_LIGHTS</span></span>\n\t\t\t\t<span class=\"token keyword\">uint</span> pixelLightCount <span class=\"token operator\">=</span> <span class=\"token function\">GetAdditionalLightsCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t\t<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">uint</span> lightIndex <span class=\"token operator\">=</span> <span class=\"token number\">0u</span><span class=\"token punctuation\">;</span> lightIndex <span class=\"token operator\">&lt;</span> pixelLightCount<span class=\"token punctuation\">;</span> <span class=\"token operator\">++</span>lightIndex<span class=\"token punctuation\">)</span>\n\t\t\t\t<span class=\"token punctuation\">{</span>\n\t\t\t\t\t\tLight addLight <span class=\"token operator\">=</span> <span class=\"token function\">GetAdditionalLight</span><span class=\"token punctuation\">(</span>lightIndex<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">.</span>worldPos<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t\t\t\t<span class=\"token keyword\">float3</span> addLightResult <span class=\"token operator\">=</span> <span class=\"token function\">LightingLambert</span><span class=\"token punctuation\">(</span>addLight<span class=\"token punctuation\">.</span>color<span class=\"token punctuation\">,</span> addLight<span class=\"token punctuation\">.</span>direction<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">.</span>normal<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> addLight<span class=\"token punctuation\">.</span>distanceAttenuation<span class=\"token punctuation\">;</span>\n\t\t\t\t\t\t<span class=\"token keyword\">float3</span> addLightSpecular <span class=\"token operator\">=</span> <span class=\"token function\">LightingSpecular</span><span class=\"token punctuation\">(</span>addLight<span class=\"token punctuation\">.</span>color<span class=\"token punctuation\">,</span> addLight<span class=\"token punctuation\">.</span>direction<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">.</span>normal<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">.</span>viewDir<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> _Gloss<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t\t\t\tc<span class=\"token punctuation\">.</span>rgb <span class=\"token operator\">+=</span> addLightResult <span class=\"token operator\">+</span> addLightSpecular<span class=\"token punctuation\">;</span>\n\t\t\t\t<span class=\"token punctuation\">}</span>\n\t\t<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span>\n\n\t\t<span class=\"token comment\">// Fog</span>\n\t\tc<span class=\"token punctuation\">.</span>rgb <span class=\"token operator\">=</span> <span class=\"token function\">MixFog</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">.</span>rgb<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">.</span>fogCoord<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\n\t\t<span class=\"token keyword\">return</span> c<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>라이트 구조체 / Light struct</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"hlsl\"><pre class=\"language-hlsl\"><code class=\"language-hlsl\"><span class=\"token comment\">// frag()</span>\nLight mainLight <span class=\"token operator\">=</span> <span class=\"token function\">GetMainLight</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">.</span>shadowCoord<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Lighting.hlsl</span>\n<span class=\"token keyword\">struct</span> <span class=\"token class-name\">Light</span>\n<span class=\"token punctuation\">{</span>\n\t\t<span class=\"token keyword\">half3</span> direction<span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">half3</span> color<span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">half</span>  distanceAttenuation<span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">half</span>  shadowAttenuation<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Lighting.hlsl</span>\nLight <span class=\"token function\">GetMainLight</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n\t\tLight light<span class=\"token punctuation\">;</span>\n\t\tlight<span class=\"token punctuation\">.</span>direction <span class=\"token operator\">=</span> _MainLightPosition<span class=\"token punctuation\">.</span>xyz<span class=\"token punctuation\">;</span>\n\t\t<span class=\"token comment\">// unity_LightData.z is 1 when not culled by the culling mask, otherwise 0.</span>\n\t\tlight<span class=\"token punctuation\">.</span>distanceAttenuation <span class=\"token operator\">=</span> unity_LightData<span class=\"token punctuation\">.</span>z<span class=\"token punctuation\">;</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">if</span> <span class=\"token expression\"><span class=\"token function\">defined</span><span class=\"token punctuation\">(</span>LIGHTMAP_ON<span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token function\">defined</span><span class=\"token punctuation\">(</span>_MIXED_LIGHTING_SUBTRACTIVE<span class=\"token punctuation\">)</span></span></span>\n\t\t<span class=\"token comment\">// unity_ProbesOcclusion.x is the mixed light probe occlusion data</span>\n\t\tlight<span class=\"token punctuation\">.</span>distanceAttenuation <span class=\"token operator\">*=</span> unity_ProbesOcclusion<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">;</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span>\n\t\tlight<span class=\"token punctuation\">.</span>shadowAttenuation <span class=\"token operator\">*=</span> unity_ProbesOcclusion<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">;</span>\n\t\tlight<span class=\"token punctuation\">.</span>color <span class=\"token operator\">=</span> _MainLightColor<span class=\"token punctuation\">.</span>rgb<span class=\"token punctuation\">;</span>\n\n\t\t<span class=\"token keyword\">return</span> light<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\nLight <span class=\"token function\">GetMainLight</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">float4</span> shadowCoord<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n\t\tLight light <span class=\"token operator\">=</span> <span class=\"token function\">GetMainLight</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tlight<span class=\"token punctuation\">.</span>shadowAttenuation <span class=\"token operator\">=</span> <span class=\"token function\">MainLightRealtimeShadow</span><span class=\"token punctuation\">(</span>shadowCoord<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">return</span> light<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li><em>Lighting.hlsl</em>에서 해당 내용을 확인할 수 있습니다</li>\n<li><code class=\"language-text\">GetMainLight</code>의 인자를 비워두느냐 <code class=\"language-text\">shadowCoord</code>를 넣어주느냐에 따라 <code class=\"language-text\">Attenuation</code>값이 달라집니다</li>\n<li>굳이 구조체로 안해도 <code class=\"language-text\">_MainLightPosition.xyz</code>라는 값으로 메인라이트의 포지션을 가져올 수 있긴 합니다</li>\n<li>하지만 Light 구조체를 이용해야 <code class=\"language-text\">Attenuation</code>값들을 이용할 수 있으니 습관을 들이도록 합시다</li>\n</ul>\n<p><strong>감쇠 / Attenuation</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"hlsl\"><pre class=\"language-hlsl\"><code class=\"language-hlsl\"><span class=\"token comment\">// Lighting.hlsl</span>\nflaot3 lightVector <span class=\"token operator\">=</span> lightPositionWS<span class=\"token punctuation\">.</span>xyz <span class=\"token operator\">-</span> positionWS <span class=\"token operator\">*</span> lightPositionWS<span class=\"token punctuation\">.</span>w<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">float</span> distanceSqr <span class=\"token operator\">=</span> <span class=\"token function\">max</span><span class=\"token punctuation\">(</span><span class=\"token function\">dot</span><span class=\"token punctuation\">(</span>lightVector<span class=\"token punctuation\">,</span> lightVector<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> HALF_MIN<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">half3</span> lightDirection <span class=\"token operator\">=</span> <span class=\"token keyword\">half3</span><span class=\"token punctuation\">(</span>lightVector <span class=\"token operator\">*</span> <span class=\"token function\">rsqrt</span><span class=\"token punctuation\">(</span>distanceSqr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">half</span> attenuation <span class=\"token operator\">=</span> <span class=\"token function\">DistanceAttenuation</span><span class=\"token punctuation\">(</span>distanceSqr<span class=\"token punctuation\">,</span> distanceAndSpotAttenuation<span class=\"token punctuation\">.</span>xy<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token function\">AngleAttenuation</span><span class=\"token punctuation\">(</span>spotDirection<span class=\"token punctuation\">.</span>xyz<span class=\"token punctuation\">,</span> lightDirection<span class=\"token punctuation\">,</span> distanceAndSpotAttenuation<span class=\"token punctuation\">.</span>zw<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nLight light<span class=\"token punctuation\">;</span>\nlight<span class=\"token punctuation\">.</span>direction <span class=\"token operator\">=</span> lightDirection<span class=\"token punctuation\">;</span>\nlight<span class=\"token punctuation\">.</span>distanceAttenuation <span class=\"token operator\">=</span> attenuation<span class=\"token punctuation\">;</span>\nlight<span class=\"token punctuation\">.</span>shadowAttenuation <span class=\"token operator\">=</span> <span class=\"token function\">AdditionalLightRealtimeShadow</span><span class=\"token punctuation\">(</span>perObjectLightInedx<span class=\"token punctuation\">,</span> positionWS<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nlight<span class=\"token punctuation\">.</span>color <span class=\"token operator\">=</span> color<span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">distanceAttenuation</code>은 광원과 표면의 ‘거리’에 대한 감쇠와 스팟라이트일 때 스팟라이트의 ‘범위각(AngleAttenuation)’에 zw. 이렇게 두가지의 값이 곱해진 값입니다. 즉 Directional Light일 경우에는 감쇠가 되지 않으므로 항상 1인 값입니다. (첫줄에서 <code class=\"language-text\">lightPositionWS.w</code>를 곱해주어 이것을 판별합니다. 디렉셔널 라이트는 이 값이 0이 되어, <code class=\"language-text\">lightPositionWS</code>만으로 벡터를 구할 수 있습니다.</li>\n<li><code class=\"language-text\">shadowAttenuation</code>은 실시간 그림자가 드리워져서 어두워지는 것을 의미합니다 (리얼타임 섀도우)</li>\n</ul>\n<p><strong>실시간 그림자 / Realtime Shadow</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"hlsl\"><pre class=\"language-hlsl\"><code class=\"language-hlsl\"><span class=\"token comment\">// Lighting.hlsl</span>\nLight <span class=\"token function\">GetMainLight</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">float4</span> shadowCoord<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n\t\tLight light <span class=\"token operator\">=</span> <span class=\"token function\">GetMainLight</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tlight<span class=\"token punctuation\">.</span>shadowAttenuation <span class=\"token operator\">=</span> <span class=\"token function\">MainLightRealtimeShadow</span><span class=\"token punctuation\">(</span>shadowCoord<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">return</span> light<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">pragma</span> <span class=\"token expression\">multi_compile _ _SHADOWS_SOFT</span></span>\n\n<span class=\"token comment\">// Shadows.hlsl</span>\n<span class=\"token keyword\">half</span> <span class=\"token function\">MainLightRealtimeShadow</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">float4</span> shadowCoord<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">if</span> <span class=\"token expression\"><span class=\"token operator\">!</span><span class=\"token function\">defined</span><span class=\"token punctuation\">(</span>_MAIN_LIGHT_SHADOWS<span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token function\">defined</span><span class=\"token punctuation\">(</span>_RECEIVE_SHADOWS_OFF<span class=\"token punctuation\">)</span></span></span>\n\t\t<span class=\"token keyword\">return</span> <span class=\"token number\">1.0h</span><span class=\"token punctuation\">;</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span>\n\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">if</span> <span class=\"token expression\">SHADOWS_SCREEN</span></span>\n\t\t<span class=\"token keyword\">return</span> <span class=\"token function\">SamplesScreenSpaceShadowmap</span><span class=\"token punctuation\">(</span>shadowCoord<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">else</span></span>\n\t\tShadowSamplingData shadowSamplingData <span class=\"token operator\">=</span> <span class=\"token function\">GetMainLightShadowSamplingData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">half4</span> shadowParams <span class=\"token operator\">=</span> <span class=\"token function\">GetMainLightShadowParams</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">return</span> <span class=\"token function\">SampleShadowmap</span><span class=\"token punctuation\">(</span><span class=\"token function\">TEXUTRE2D_ARGS</span><span class=\"token punctuation\">(</span>_MainLightShadowmapTexture<span class=\"token punctuation\">,</span> sampler_MainLightShadowmapTexture<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> shadowCoord<span class=\"token punctuation\">,</span> shadowSamplingData<span class=\"token punctuation\">,</span> shadowParams<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span>\n<span class=\"token punctuation\">}</span>\n\nreal <span class=\"token function\">SampleShadowmap</span><span class=\"token punctuation\">(</span><span class=\"token function\">TEXTURE2D_SHADOW_PARAM</span><span class=\"token punctuation\">(</span>ShadowMap<span class=\"token punctuation\">,</span> smapler_ShadowMap<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">float4</span> shadowCoord<span class=\"token punctuation\">,</span> ShadowSamplingData samplingData<span class=\"token punctuation\">,</span> <span class=\"token keyword\">half4</span> shadowParams<span class=\"token punctuation\">,</span> <span class=\"token keyword\">bool</span> isPerspectiveProjection <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n\t\t<span class=\"token comment\">// Compiler will optimize this branch away as long as isPerspectiveProjection is known at compile time</span>\n\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>isPerspectiveProjection<span class=\"token punctuation\">)</span>\n\t\t\t\tshadowCoord<span class=\"token punctuation\">.</span>xyz <span class=\"token operator\">/=</span> shadowCoord<span class=\"token punctuation\">.</span>w<span class=\"token punctuation\">;</span>\n\n\t\treal attenuation<span class=\"token punctuation\">;</span>\n\t\treal shadowStrength <span class=\"token operator\">=</span> shadowParams<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">;</span>\n\n\t\t<span class=\"token comment\">// TODO : We could branch on if this light has soft shadow (shadowParams/y) to save perf on some platforms.</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">ifdef</span> <span class=\"token expression\">_SHADOW_SOFT</span></span>\n\t\tattenuation <span class=\"token operator\">=</span> <span class=\"token function\">SampleShadowmapFiltered</span><span class=\"token punctuation\">(</span><span class=\"token function\">TEXTURE2D_SHADOW_ARGS</span><span class=\"token punctuation\">(</span>ShadowMap<span class=\"token punctuation\">,</span> sampler_ShadowMap<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> shadowCoord<span class=\"token punctuation\">,</span> samplingData<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">else</span></span>\n\t\t<span class=\"token comment\">// 1-tap hardware comparison</span>\n\t\tattenuation <span class=\"token operator\">=</span> <span class=\"token function\">SAMPLE_TEXTURE2D_SHADOW</span><span class=\"token punctuation\">(</span>ShadowMap<span class=\"token punctuation\">,</span> sampler_ShadowMap<span class=\"token punctuation\">,</span> shadowCoord<span class=\"token punctuation\">.</span>xyz<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span>\n\n\t\tattenuation <span class=\"token operator\">=</span> <span class=\"token function\">LerpWhiteTo</span><span class=\"token punctuation\">(</span>attenuation<span class=\"token punctuation\">,</span> shadowStrength<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t\t<span class=\"token comment\">// Shadow coords that fall out of the light frustum volume must always return attenuation 1.0</span>\n\t\t<span class=\"token comment\">// TODO : We could use branch here to save som perf on som platforms.</span>\n\t\t<span class=\"token keyword\">return</span> <span class=\"token function\">BEYOND_SHADOW_FAR</span><span class=\"token punctuation\">(</span>shadowCoord<span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> <span class=\"token number\">1.0</span> <span class=\"token operator\">:</span> attenuation<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\nreal <span class=\"token function\">SampleShadowmapFiltered</span><span class=\"token punctuation\">(</span><span class=\"token function\">TEXTURE2D_SHADOW_PARAM</span><span class=\"token punctuation\">(</span>ShadowMap<span class=\"token punctuation\">,</span> sampler_ShadowMap<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">float4</span> shadowCoord<span class=\"token punctuation\">,</span> ShadowSamplingData samplingData<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    real attenuation<span class=\"token punctuation\">;</span>\n\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">if</span> <span class=\"token expression\"><span class=\"token function\">defined</span><span class=\"token punctuation\">(</span>SHADER_API_MOBILE<span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> <span class=\"token function\">defined</span><span class=\"token punctuation\">(</span>SHADER_API_SWITCH<span class=\"token punctuation\">)</span></span></span>\n\t\t<span class=\"token comment\">// 4-tap hardware comparison</span>\n\t\treal4 attenuation4<span class=\"token punctuation\">;</span>\n\t\tattenuation4<span class=\"token punctuation\">.</span>x <span class=\"token operator\">=</span> <span class=\"token function\">SAMPLE_TEXTURE2D_SHADOW</span><span class=\"token punctuation\">(</span>ShadowMap<span class=\"token punctuation\">,</span> sampler_ShadowMap<span class=\"token punctuation\">,</span> shadowCoord<span class=\"token punctuation\">.</span>xyz <span class=\"token operator\">+</span> samplingData<span class=\"token punctuation\">.</span>ShadowOffset0<span class=\"token punctuation\">.</span>xyz<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tattenuation4<span class=\"token punctuation\">.</span>y <span class=\"token operator\">=</span> <span class=\"token function\">SAMPLE_TEXTURE2D_SHADOW</span><span class=\"token punctuation\">(</span>ShadowMap<span class=\"token punctuation\">,</span> sampler_ShadowMap<span class=\"token punctuation\">,</span> shadowCoord<span class=\"token punctuation\">.</span>xyz <span class=\"token operator\">+</span> samplingData<span class=\"token punctuation\">.</span>ShadowOffset1<span class=\"token punctuation\">.</span>xyz<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tattenuation4<span class=\"token punctuation\">.</span>z <span class=\"token operator\">=</span> <span class=\"token function\">SAMPLE_TEXTURE2D_SHADOW</span><span class=\"token punctuation\">(</span>ShadowMap<span class=\"token punctuation\">,</span> sampler_ShadowMap<span class=\"token punctuation\">,</span> shadowCoord<span class=\"token punctuation\">.</span>xyz <span class=\"token operator\">+</span> samplingData<span class=\"token punctuation\">.</span>ShadowOffset2<span class=\"token punctuation\">.</span>xyz<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tattenuation4<span class=\"token punctuation\">.</span>w <span class=\"token operator\">=</span> <span class=\"token function\">SAMPLE_TEXTURE2D_SHADOW</span><span class=\"token punctuation\">(</span>ShadowMap<span class=\"token punctuation\">,</span> sampler_ShadowMap<span class=\"token punctuation\">,</span> shadowCoord<span class=\"token punctuation\">.</span>xyz <span class=\"token operator\">+</span> samplingData<span class=\"token punctuation\">.</span>ShadowOffset3<span class=\"token punctuation\">.</span>xyz<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tattenuation <span class=\"token operator\">=</span> <span class=\"token function\">dot</span><span class=\"token punctuation\">(</span>attenuation4<span class=\"token punctuation\">,</span> <span class=\"token number\">0.25</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">else</span></span>\n\t\t<span class=\"token keyword\">float</span> fetchesWeights<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">float2</span> fetchesUV<span class=\"token punctuation\">[</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token function\">SampleShadow_ComputeSamples_Tent_5x5</span><span class=\"token punctuation\">(</span>samplingData<span class=\"token punctuation\">.</span>shadowmapSize<span class=\"token punctuation\">,</span> shadowCoord<span class=\"token punctuation\">.</span>xy<span class=\"token punctuation\">,</span> fetchesWeights<span class=\"token punctuation\">,</span> fetchesUV<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t\tattenuation <span class=\"token operator\">=</span> fetchesWeights<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token function\">SAMPLE_TEXTURE2D_SHADOW</span><span class=\"token punctuation\">(</span>ShadowMap<span class=\"token punctuation\">,</span> sampler_ShadowMap<span class=\"token punctuation\">,</span> <span class=\"token keyword\">float3</span><span class=\"token punctuation\">(</span>fetchesUV<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>xy<span class=\"token punctuation\">,</span> shadowCoord<span class=\"token punctuation\">.</span>z<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tattenuation <span class=\"token operator\">+=</span> fetchesWeights<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token function\">SAMPLE_TEXTURE2D_SHADOW</span><span class=\"token punctuation\">(</span>ShadowMap<span class=\"token punctuation\">,</span> sampler_ShadowMap<span class=\"token punctuation\">,</span> <span class=\"token keyword\">float3</span><span class=\"token punctuation\">(</span>fetchesUV<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>xy<span class=\"token punctuation\">,</span> shadowCoord<span class=\"token punctuation\">.</span>z<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tattenuation <span class=\"token operator\">+=</span> fetchesWeights<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token function\">SAMPLE_TEXTURE2D_SHADOW</span><span class=\"token punctuation\">(</span>ShadowMap<span class=\"token punctuation\">,</span> sampler_ShadowMap<span class=\"token punctuation\">,</span> <span class=\"token keyword\">float3</span><span class=\"token punctuation\">(</span>fetchesUV<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>xy<span class=\"token punctuation\">,</span> shadowCoord<span class=\"token punctuation\">.</span>z<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tattenuation <span class=\"token operator\">+=</span> fetchesWeights<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token function\">SAMPLE_TEXTURE2D_SHADOW</span><span class=\"token punctuation\">(</span>ShadowMap<span class=\"token punctuation\">,</span> sampler_ShadowMap<span class=\"token punctuation\">,</span> <span class=\"token keyword\">float3</span><span class=\"token punctuation\">(</span>fetchesUV<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>xy<span class=\"token punctuation\">,</span> shadowCoord<span class=\"token punctuation\">.</span>z<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tattenuation <span class=\"token operator\">+=</span> fetchesWeights<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token function\">SAMPLE_TEXTURE2D_SHADOW</span><span class=\"token punctuation\">(</span>ShadowMap<span class=\"token punctuation\">,</span> sampler_ShadowMap<span class=\"token punctuation\">,</span> <span class=\"token keyword\">float3</span><span class=\"token punctuation\">(</span>fetchesUV<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>xy<span class=\"token punctuation\">,</span> shadowCoord<span class=\"token punctuation\">.</span>z<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tattenuation <span class=\"token operator\">+=</span> fetchesWeights<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token function\">SAMPLE_TEXTURE2D_SHADOW</span><span class=\"token punctuation\">(</span>ShadowMap<span class=\"token punctuation\">,</span> sampler_ShadowMap<span class=\"token punctuation\">,</span> <span class=\"token keyword\">float3</span><span class=\"token punctuation\">(</span>fetchesUV<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>xy<span class=\"token punctuation\">,</span> shadowCoord<span class=\"token punctuation\">.</span>z<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tattenuation <span class=\"token operator\">+=</span> fetchesWeights<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token function\">SAMPLE_TEXTURE2D_SHADOW</span><span class=\"token punctuation\">(</span>ShadowMap<span class=\"token punctuation\">,</span> sampler_ShadowMap<span class=\"token punctuation\">,</span> <span class=\"token keyword\">float3</span><span class=\"token punctuation\">(</span>fetchesUV<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>xy<span class=\"token punctuation\">,</span> shadowCoord<span class=\"token punctuation\">.</span>z<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tattenuation <span class=\"token operator\">+=</span> fetchesWeights<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token function\">SAMPLE_TEXTURE2D_SHADOW</span><span class=\"token punctuation\">(</span>ShadowMap<span class=\"token punctuation\">,</span> sampler_ShadowMap<span class=\"token punctuation\">,</span> <span class=\"token keyword\">float3</span><span class=\"token punctuation\">(</span>fetchesUV<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>xy<span class=\"token punctuation\">,</span> shadowCoord<span class=\"token punctuation\">.</span>z<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tattenuation <span class=\"token operator\">+=</span> fetchesWeights<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">*</span> <span class=\"token function\">SAMPLE_TEXTURE2D_SHADOW</span><span class=\"token punctuation\">(</span>ShadowMap<span class=\"token punctuation\">,</span> sampler_ShadowMap<span class=\"token punctuation\">,</span> <span class=\"token keyword\">float3</span><span class=\"token punctuation\">(</span>fetchesUV<span class=\"token punctuation\">[</span><span class=\"token number\">8</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>xy<span class=\"token punctuation\">,</span> shadowCoord<span class=\"token punctuation\">.</span>z<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span>\n\n    <span class=\"token keyword\">return</span> attenuation<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">GetMainLight</code>의 인자에 <code class=\"language-text\">ShadowCoord</code>를 넣으면 <code class=\"language-text\">MainLightRealtimeShadow()</code>계산</li>\n<li><code class=\"language-text\">SampleShadowMap()</code>안에서 <code class=\"language-text\">_SHADOWS_SOFT</code> 키워드가 들어오면 <code class=\"language-text\">SampleShadowmapFiltered()</code> 함수를 실행</li>\n<li>셰이더 그래프에서는 글로벌 키워드 작성이 불가능하므로 커스텀 노드에서 <code class=\"language-text\">SampleShadowmapFiltered()</code> 함수를 직접 실행히야합니다</li>\n</ul>\n<p><strong>램버트 라이트 모델 (디퓨즈) / LightingLambert</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"hlsl\"><pre class=\"language-hlsl\"><code class=\"language-hlsl\"><span class=\"token comment\">// frag()</span>\n\n<span class=\"token comment\">// Diffuse</span>\n<span class=\"token keyword\">float3</span> lambert <span class=\"token operator\">=</span> <span class=\"token function\">LightingLambert</span><span class=\"token punctuation\">(</span>mainLight<span class=\"token punctuation\">.</span>color<span class=\"token punctuation\">,</span> mainLight<span class=\"token punctuation\">.</span>direction<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">.</span>normal<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">float4</span> c <span class=\"token operator\">=</span> <span class=\"token function\">SAMPLE_TEXTURE2D</span><span class=\"token punctuation\">(</span>_MainTex<span class=\"token punctuation\">,</span> smapler_MainTex<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">.</span>texcoord<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> _Color<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Lighting.hlsl</span>\n<span class=\"token keyword\">half3</span> <span class=\"token function\">LightingLambert</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">half3</span> lightColor<span class=\"token punctuation\">,</span> <span class=\"token keyword\">half3</span> lightDir<span class=\"token punctuation\">,</span> <span class=\"token keyword\">half3</span> normal<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n\t\t<span class=\"token keyword\">half</span> NdotL <span class=\"token operator\">=</span> <span class=\"token function\">saturate</span><span class=\"token punctuation\">(</span><span class=\"token function\">dot</span><span class=\"token punctuation\">(</span>normal<span class=\"token punctuation\">,</span> lightDir<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">return</span> lightColor <span class=\"token operator\">*</span> NdotL<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>램버트는 라이트벡터와 노멀의 내적연산으로 간단하게 구할 수 있지만 코드정리를 위해 <em>Lighting.hlsl</em>의 <code class=\"language-text\">LightingLambert</code>함수를 써 주었습니다 (굳이 쓰지 않아도 됩니다)</li>\n<li>NPR이나 Stylized 한 표현을 하고싶다면 <code class=\"language-text\">LightingLambert</code>함수를 쓰지말고, 내적만 한 NdotL 값에 <code class=\"language-text\">* 0.5 + 0.5</code> 를 한 후 <code class=\"language-text\">SmoothStep</code>을 사용하면 됩니다 (컬러는 그 후에 곱하면 됩니다)</li>\n</ul>\n<p><strong>GI</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"hlsl\"><pre class=\"language-hlsl\"><code class=\"language-hlsl\"><span class=\"token comment\">// frag()</span>\n<span class=\"token keyword\">half3</span> ambient <span class=\"token operator\">=</span> <span class=\"token function\">SampleSH</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">.</span>normal<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Lighting.hlsl</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">ifdef</span> <span class=\"token expression\">LIGHTMAP_ON</span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name function\">SMAPLE_GI</span><span class=\"token expression\"><span class=\"token punctuation\">(</span>lmName<span class=\"token punctuation\">,</span> shName<span class=\"token punctuation\">,</span> normalWSName<span class=\"token punctuation\">)</span> <span class=\"token function\">SampleLightmap</span><span class=\"token punctuation\">(</span>lmName<span class=\"token punctuation\">,</span> normalWSName<span class=\"token punctuation\">)</span></span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">else</span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name function\">SMAPLE_GI</span><span class=\"token expression\"><span class=\"token punctuation\">(</span>lmName<span class=\"token punctuation\">,</span> shName<span class=\"token punctuation\">,</span> normalWSName<span class=\"token punctuation\">)</span> <span class=\"token function\">SampleSHPixel</span><span class=\"token punctuation\">(</span>shName<span class=\"token punctuation\">,</span> normalWSName<span class=\"token punctuation\">)</span></span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span>\n\n<span class=\"token keyword\">half3</span> indirectDiffuse <span class=\"token operator\">=</span> bakedGI <span class=\"token operator\">*</span> occlusion<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">half3</span> indirectSpecular <span class=\"token operator\">=</span> <span class=\"token function\">GlossyEnvironmentReflection</span><span class=\"token punctuation\">(</span>reflectVector<span class=\"token punctuation\">,</span> brdfData<span class=\"token punctuation\">.</span>perceptualRoughness<span class=\"token punctuation\">,</span> occlusion<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">half3</span> <span class=\"token function\">SampleSHVertex</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">half3</span> normalWS<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">if</span> <span class=\"token expression\"><span class=\"token function\">defined</span><span class=\"token punctuation\">(</span>EVALUATE_SH_VERTEX<span class=\"token punctuation\">)</span></span></span>\n\t\t<span class=\"token keyword\">return</span> <span class=\"token function\">max</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">half3</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">SampleSH</span><span class=\"token punctuation\">(</span>normalWS<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">elif</span> <span class=\"token expression\"><span class=\"token function\">defined</span><span class=\"token punctuation\">(</span>EVALUATE_SH_MIXED<span class=\"token punctuation\">)</span></span></span>\n\t\t<span class=\"token comment\">// no max since this is only L2 contribution</span>\n\t\t<span class=\"token keyword\">return</span> <span class=\"token function\">SHEvlaLinearL2</span><span class=\"token punctuation\">(</span>normalWS<span class=\"token punctuation\">,</span> unity_SHBr<span class=\"token punctuation\">,</span> unity_SHBg<span class=\"token punctuation\">,</span> unity_SHBb<span class=\"token punctuation\">,</span> unity_SHC<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span>\n\n\t\t<span class=\"token comment\">// fully per-pixel. Nothing to compute</span>\n\t\t<span class=\"token keyword\">return</span> <span class=\"token keyword\">half3</span><span class=\"token punctuation\">(</span><span class=\"token number\">0.0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0.0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">half3</span> <span class=\"token function\">SampleSHPixel</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">half3</span> L2Term<span class=\"token punctuation\">,</span> <span class=\"token keyword\">half3</span> normalWS<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">if</span> <span class=\"token expression\"><span class=\"token function\">defined</span><span class=\"token punctuation\">(</span>EVALUATE_SH_VERTEX<span class=\"token punctuation\">)</span></span></span>\n\t\t<span class=\"token keyword\">return</span> L2Term<span class=\"token punctuation\">;</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">elif</span> <span class=\"token expression\"><span class=\"token function\">defiend</span><span class=\"token punctuation\">(</span>EVALUATE_SH_MIXED<span class=\"token punctuation\">)</span></span></span>\n\t\t<span class=\"token keyword\">half3</span> L0L1Term <span class=\"token operator\">=</span> <span class=\"token function\">SHEvalLinearL0L1</span><span class=\"token punctuation\">(</span>normalWS<span class=\"token punctuation\">,</span> unity_SHAr<span class=\"token punctuation\">,</span> unity_SHAg<span class=\"token punctuation\">,</span> unity_SHAb<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">return</span> <span class=\"token function\">max</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">half3</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> L2Term <span class=\"token operator\">+</span> L0L1Term<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span>\n\n\t\t<span class=\"token comment\">// Default : Evaluate SH fully per-pixel</span>\n\t\t<span class=\"token keyword\">return</span> <span class=\"token function\">SampleSH</span><span class=\"token punctuation\">(</span>normalWS<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>GI는 <code class=\"language-text\">indirectDiffuse</code>와 <code class=\"language-text\">indirectSpecular</code>가 있습니다</li>\n<li><code class=\"language-text\">indirectDiffuse</code>는 라이트맵이 있을때는 라이트맵으로 계산하고 라이트맵이 없을때는 <code class=\"language-text\">VertexSH + PixelSH</code>로 계산합니다</li>\n<li>SH는 <code class=\"language-text\">SampleSH</code>함수로 간단하게 <code class=\"language-text\">VertexSH + PiexlSH</code>를 한 번에 계산 가능합니다</li>\n<li><code class=\"language-text\">indirectSpecular</code>는 큐브맵으로 계산합니다. <code class=\"language-text\">GlossyEnvironmentReflection</code> 함수를 추가해주세요</li>\n<li>즉, BRDF 데이터를 사용하지 않을때에는 <code class=\"language-text\">indirectDiffuse</code>만 쓴다 정도로 정리하면 될 것 같습니다</li>\n</ul>\n<p><strong>구면조화 / SH</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"hlsl\"><pre class=\"language-hlsl\"><code class=\"language-hlsl\"><span class=\"token comment\">// Lighting.hlsl</span>\n<span class=\"token keyword\">half3</span> <span class=\"token function\">SampleSH</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">half3</span> normalWS<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n\t\t<span class=\"token comment\">//LPPV is not supported in Lightweight Pipeline</span>\n\t\treal4 SHCoefficients<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\t\tSHCoefficients<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> unity_SHAr<span class=\"token punctuation\">;</span>\n\t\tSHCoefficients<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> unity_SHAg<span class=\"token punctuation\">;</span>\n\t\tSHCoefficients<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> unity_SHAb<span class=\"token punctuation\">;</span>\n\t\tSHCoefficients<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> unity_SHBr<span class=\"token punctuation\">;</span>\n\t\tSHCoefficients<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> unity_SHBg<span class=\"token punctuation\">;</span>\n\t\tSHCoefficients<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> unity_SHBb<span class=\"token punctuation\">;</span>\n\t\tSHCoefficients<span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> unity_SHC<span class=\"token punctuation\">;</span>\n\n\t\t<span class=\"token keyword\">return</span> <span class=\"token function\">max</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">half3</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">SampleSH9</span><span class=\"token punctuation\">(</span>SHCoefficients<span class=\"token punctuation\">,</span> normalWS<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">float3</span> <span class=\"token function\">SmapleSH9</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">float4</span> SHCoefficients<span class=\"token punctuation\">[</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">float3</span> N<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n\t\t<span class=\"token keyword\">float3</span> res <span class=\"token operator\">=</span> <span class=\"token function\">SHEvalLinearL0L1</span><span class=\"token punctuation\">(</span>N<span class=\"token punctuation\">,</span> shAr<span class=\"token punctuation\">,</span> shAg<span class=\"token punctuation\">,</span> shAb<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Linear + constant polynomial terms</span>\n\t\tres <span class=\"token operator\">+=</span> <span class=\"token function\">SHEvalLinearL2</span><span class=\"token punctuation\">(</span>N<span class=\"token punctuation\">,</span> shBr<span class=\"token punctuation\">,</span> shBg<span class=\"token punctuation\">,</span> shBb<span class=\"token punctuation\">,</span> shCr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>   <span class=\"token comment\">// Quadratic polynomials</span>\n\t\t<span class=\"token keyword\">return</span> res<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// EntityLighting.hlsl</span>\nreal3 <span class=\"token function\">SHEvalLinearL0L1</span><span class=\"token punctuation\">(</span>real3 N<span class=\"token punctuation\">,</span> real4 shAr<span class=\"token punctuation\">,</span> real4 shAg<span class=\"token punctuation\">,</span> real4 shAb<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n\t\treal4 vA <span class=\"token operator\">=</span> <span class=\"token function\">real4</span><span class=\"token punctuation\">(</span>N<span class=\"token punctuation\">,</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\n\t\treal3 x1<span class=\"token punctuation\">;</span>\n\t\t<span class=\"token comment\">// Linear (L1) + constant (L0) polynomial terms</span>\n\t\tx1<span class=\"token punctuation\">.</span>r <span class=\"token operator\">=</span> <span class=\"token function\">dot</span><span class=\"token punctuation\">(</span>shAr<span class=\"token punctuation\">,</span> vA<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tx1<span class=\"token punctuation\">.</span>g <span class=\"token operator\">=</span> <span class=\"token function\">dot</span><span class=\"token punctuation\">(</span>shAg<span class=\"token punctuation\">,</span> vA<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tx1<span class=\"token punctuation\">.</span>b <span class=\"token operator\">=</span> <span class=\"token function\">dot</span><span class=\"token punctuation\">(</span>shAb<span class=\"token punctuation\">,</span> vA<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\n\t\t<span class=\"token keyword\">return</span> x1<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\nreal3 <span class=\"token function\">SHEvalLinearL2</span><span class=\"token punctuation\">(</span>real3 N<span class=\"token punctuation\">,</span> real4 shBr<span class=\"token punctuation\">,</span> real4 shBg<span class=\"token punctuation\">,</span> real4 shBb<span class=\"token punctuation\">,</span> real4 shC<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n\t\treal3 x2<span class=\"token punctuation\">;</span>\n\t\t<span class=\"token comment\">// 4 of the quadratic (L2) polynomials</span>\n\t\treal4 vB <span class=\"token operator\">=</span> N<span class=\"token punctuation\">.</span>xyzz <span class=\"token operator\">*</span> N<span class=\"token punctuation\">.</span>yzzx<span class=\"token punctuation\">;</span>\n\t\tx2<span class=\"token punctuation\">.</span>r <span class=\"token operator\">=</span> <span class=\"token function\">dot</span><span class=\"token punctuation\">(</span>shBr<span class=\"token punctuation\">,</span> vB<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tx2<span class=\"token punctuation\">.</span>g <span class=\"token operator\">=</span> <span class=\"token function\">dot</span><span class=\"token punctuation\">(</span>shBg<span class=\"token punctuation\">,</span> vB<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tx2<span class=\"token punctuation\">.</span>b <span class=\"token operator\">=</span> <span class=\"token function\">dot</span><span class=\"token punctuation\">(</span>shBb<span class=\"token punctuation\">,</span> vB<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t\t<span class=\"token comment\">// Final (5th) quadratic (L2) polynomial</span>\n\t\treal vC <span class=\"token operator\">=</span> N<span class=\"token punctuation\">.</span>x <span class=\"token operator\">*</span> N<span class=\"token punctuation\">.</span>x <span class=\"token operator\">-</span> N<span class=\"token punctuation\">.</span>y <span class=\"token operator\">*</span> N<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">;</span>\n\t\treal3 x3 <span class=\"token operator\">=</span> shC<span class=\"token punctuation\">.</span>rgb <span class=\"token operator\">*</span> vC<span class=\"token punctuation\">;</span>\n\n\t\t<span class=\"token keyword\">return</span> x2 <span class=\"token operator\">+</span> x3<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> </code></pre></div>\n<ul>\n<li>SH는 Spherical Harmonics의 줄임</li>\n<li>간단하게 표현하면 노멀방향의 radiance정보들을 주기함수(<code class=\"language-text\">sin</code>, <code class=\"language-text\">cos</code>)를 이용하여 다양한 길이의 파장 조합 형태로 미리 계산하고 사용하는 것입니다. (Furier Transform)</li>\n<li>구면조화 함수에는 계수라고해서 파장 형태를 다양하게 나타내는 수치가 있는데 유니티에서는 9를 사용 (3단계)</li>\n<li>계수가 높아질수록 더 디테일한 값을 구할 수 있겠지만 적당히 근사치로 표현하는 편</li>\n<li><code class=\"language-text\">VertexSH</code>는 <code class=\"language-text\">SHEvalLinearL2</code>를, <code class=\"language-text\">PixelSH</code>는 <code class=\"language-text\">SHEvalLinearL0L1</code>함수를 각각 실행합니다.</li>\n</ul>\n<p><strong>추가 라이트 / Additional Light</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"hlsl\"><pre class=\"language-hlsl\"><code class=\"language-hlsl\"><span class=\"token comment\">// frag()</span>\n<span class=\"token comment\">// Get Additional Light</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">ifdef</span> <span class=\"token expression\">_ADDITIONAL_LIGHTS</span></span>\n\t\t<span class=\"token keyword\">uint</span> <span class=\"token punctuation\">[</span>ixelLightCount <span class=\"token operator\">=</span> <span class=\"token function\">GetAdditionalLightsCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">uint</span> lightIndex <span class=\"token operator\">=</span> <span class=\"token number\">0u</span><span class=\"token punctuation\">;</span> lightIndex <span class=\"token operator\">&lt;</span> pixelLightCount<span class=\"token punctuation\">;</span> <span class=\"token operator\">++</span>lightIndex<span class=\"token punctuation\">)</span>\n\t\t<span class=\"token punctuation\">{</span>\n\t\t\t\tLight addLight <span class=\"token operator\">=</span> <span class=\"token function\">GetAdditionalLight</span><span class=\"token punctuation\">(</span>lightIndex<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">.</span>worldPos<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t\t<span class=\"token keyword\">float3</span> addLightResult <span class=\"token operator\">=</span> <span class=\"token function\">LightingLambert</span><span class=\"token punctuation\">(</span>addLight<span class=\"token punctuation\">.</span>color<span class=\"token punctuation\">,</span> addLight<span class=\"token punctuation\">.</span>direction<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">.</span>normal<span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> addLight<span class=\"token punctuation\">.</span>distanceAttenuation<span class=\"token punctuation\">;</span>\n\t\t\t\t<span class=\"token keyword\">float3</span> addLightSpecular <span class=\"token operator\">=</span> <span class=\"token function\">LightingSpecular</span><span class=\"token punctuation\">(</span>addLight<span class=\"token punctuation\">.</span>color<span class=\"token punctuation\">,</span> addLight<span class=\"token punctuation\">.</span>direction<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">.</span>normal<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">.</span>viewDir<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> _Gloss<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t\tc<span class=\"token punctuation\">.</span>rgb <span class=\"token operator\">+=</span> addLightResualt <span class=\"token operator\">+</span> addLightSpecular<span class=\"token punctuation\">;</span>\n\t\t<span class=\"token punctuation\">}</span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">endif</span></span>\n\n<span class=\"token comment\">//Light.hlsl</span>\n<span class=\"token keyword\">int</span> <span class=\"token function\">GetAdditionalLightsCount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n\t\t<span class=\"token comment\">// TODO : we need to expose in SRP api an ability for the pipeline cap the amount of lights</span>\n\t\t<span class=\"token comment\">// in the culling. This way we could do the loop branch with an uniform</span>\n\t\t<span class=\"token comment\">// This would be helpful to support baking exceeding lights in SH as well</span>\n\t\t<span class=\"token keyword\">return</span> <span class=\"token function\">min</span><span class=\"token punctuation\">(</span>_AdditionalLightsCount<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">,</span> unity_LightData<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>Legacy에서는 추가로 라이트를 연산하려면 Forward Add 패스를 사용해야 했었기 때문에 많은 라이트 = 드로우콜 상승의 주범이 되었으나, URP에서는 이렇게 라이트들을 모두 얻어와서 for문으로 한 번에 처리 가능합니다.</li>\n<li>추가 라이트는 디렉셔널 라이트가 아닐수도 있으므로, <code class=\"language-text\">distanceAttenuation</code>을 곱해주어야 제대로 라이팅 처리가 가능합니다.</li>\n<li>위에서는 <code class=\"language-text\">Lighting Lambert</code>함수를 사용했지만, 메인 라이트에서 NPR계산을 해 주었다면 추가 라이트 또한 NPR 계산을 하는 것이 통일성에는 좋습니다. 하지만 적당히 어울리는 표현을 잘 선택하는 것이 중요합니다.</li>\n</ul>\n<p><strong>스펙큘러 / LightingSpecular</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"hlsl\"><pre class=\"language-hlsl\"><code class=\"language-hlsl\"><span class=\"token comment\">// frag()</span>\no<span class=\"token punctuation\">.</span>viewDir <span class=\"token operator\">=</span> <span class=\"token function\">normalize</span><span class=\"token punctuation\">(</span>_WorldSpaceCameraPos<span class=\"token punctuation\">.</span>xyz <span class=\"token operator\">-</span> o<span class=\"token punctuation\">.</span>worldPos<span class=\"token punctuation\">.</span>xyz<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">half3</span> viewDirWS <span class=\"token operator\">=</span> <span class=\"token function\">GetCameraPositionWS</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> vertexInput<span class=\"token punctuation\">.</span>positionWS<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Lighting.hlsl</span>\n<span class=\"token keyword\">half3</span> <span class=\"token function\">LightingSpecular</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">half3</span> lightColor<span class=\"token punctuation\">,</span> <span class=\"token keyword\">half3</span> lightDir<span class=\"token punctuation\">,</span> <span class=\"token keyword\">half3</span> normal<span class=\"token punctuation\">,</span> <span class=\"token keyword\">half3</span> viewDir<span class=\"token punctuation\">,</span> <span class=\"token keyword\">half4</span> specular<span class=\"token punctuation\">,</span> <span class=\"token keyword\">half</span> smoothness<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n\t\t<span class=\"token keyword\">float3</span> halfVec <span class=\"token operator\">=</span> <span class=\"token function\">SafeNormalize</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">float3</span><span class=\"token punctuation\">(</span>lightDir<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token keyword\">float3</span><span class=\"token punctuation\">(</span>viewDir<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">half</span> NdotH <span class=\"token operator\">=</span> <span class=\"token function\">saturate</span><span class=\"token punctuation\">(</span><span class=\"token function\">dot</span><span class=\"token punctuation\">(</span>normal<span class=\"token punctuation\">,</span> halfVec<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">half</span> modifier <span class=\"token operator\">=</span> <span class=\"token function\">pow</span><span class=\"token punctuation\">(</span>NdotH<span class=\"token punctuation\">,</span> smoothness<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">half3</span> specularReflection <span class=\"token operator\">=</span> specular<span class=\"token punctuation\">.</span>rgb <span class=\"token operator\">*</span> modifier<span class=\"token punctuation\">;</span>\n\t\t<span class=\"token keyword\">return</span> lightColor <span class=\"token operator\">*</span> specularReflection<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">NdotH</code>를 구해서 직접 구현해도 되지만 이 또한 <em>Lighting.hlsl</em>안에 포함되어있습니다.</li>\n<li>카메라월드포지션은 <code class=\"language-text\">GetCameraPositionWS()</code>로 구할수도 있습니다.</li>\n<li>간단한 블린퐁 방식으로 구현된 스펙쿨러</li>\n<li>인자 중에 <code class=\"language-text\">specular</code>라고 되어있는 것은 스펙큘러 마스킹 맵을 사용 (01:17:09)</li>\n</ul>\n<hr>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#urp-%EC%99%9C-%EC%8D%A8%EC%95%BC-%ED%95%A0%EA%B9%8C%EC%9A%94\">URP 왜 써야 할까요?</a></li>\n<li><a href=\"#%EC%85%B0%EC%9D%B4%EB%8D%94-%EC%A0%9C%EC%9E%91\">셰이더 제작</a></li>\n</ul>\n</div>","frontmatter":{"date":"August 27, 2022","title":"Dev Week - URP 셰이더 뜯어보기","categories":"STUDY","author":"JunHyeong Moon","emoji":""},"fields":{"slug":"/Study/Unity_DevWeekURP/"}},"prev":{"id":"26510e7a-e1c7-5552-9880-0e36264c0ad8","html":"<blockquote>\n<p><strong>포트폴리오 개발일지를 작성했습니다.</strong></p>\n<p>포트폴리오 사이트 작업을 진행하면서 어떻게 작업했는지 기록하기 위해 개발일지를 작성했습니다.<br>\n<strong><a href=\"https://junyangyee.notion.site/portfolio-devlog\">😀 포트폴리오 사이트 개발일지 링크</a></strong></p>\n</blockquote>\n<hr>\n<h2 id=\"개발일지\" style=\"position:relative;\"><a href=\"#%EA%B0%9C%EB%B0%9C%EC%9D%BC%EC%A7%80\" aria-label=\"개발일지 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>개발일지</h2>\n<p>기존에 기록없이 그냥 진행하거나, 정리되지 않은 기록들이 많았습니다. 나중에 보면 왜 이렇게 했는지, 과거의 내가 궁금해질 때가 있더라구요. 마침 웹 개발 비스무리한건 처음 해보는 것이기도 하기에…</p>\n<p>이렇게 포트폴리오 사이트 개발일지를 작성해봅니다 :)</p>\n<h3 id=\"옵시디언으로-시작\" style=\"position:relative;\"><a href=\"#%EC%98%B5%EC%8B%9C%EB%94%94%EC%96%B8%EC%9C%BC%EB%A1%9C-%EC%8B%9C%EC%9E%91\" aria-label=\"옵시디언으로 시작 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>옵시디언으로 시작</h3>\n<p>처음엔 옵시디언에 작성했습니다.<br>\n당시 옵시디언 작성에 빠져있어서 뭐만하면 옵시디언에 글을 작성했었습니다.<br>\n다만 이걸 개발일지를 어딘가에 업로드해야한다고 생각해보니, 옵시디언 말고 블로그에 바로 업로드하는게 좋을 것 같아서 블로그에 작성했습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA+klEQVQ4y62SXXKEIBCE9yaKDjDDj5Anvf/FOjVErM3GpFYrD13IIJ/d4zycc3gVESGEgG3bsK5rEzO3M2stzu50Pc6KeklEUOtHWxWmtQ7rz2fwX4Hee+ScEWM8Pb/skEVa1CXnH4BbQHVYa0UtpblUpZS+Ad+K3F8iazERYZ5nGGMO6f65j28Dv2Jzi27GEeOuaZquAV0HkkXyBM+M0Zj7wCMyEZJYSI5wIqA9+u3I2kNHhKxOQ2wgdXcZ+PyXeR9qCaHVFfY63BciW7AjWKL/62Fk24DDMBzSPt6KrGsKghSlxe/SD10a7OceLkvBsixNpZQmZv8n8BNYU7D8ED8x1QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Portfolio_Devlog_Obsidian\"\n        title=\"Portfolio_Devlog_Obsidian\"\n        src=\"/static/3ec7abca127177672d66b416965452f8/37523/Portfolio_Devlog_001.png\"\n        srcset=\"/static/3ec7abca127177672d66b416965452f8/e9ff0/Portfolio_Devlog_001.png 180w,\n/static/3ec7abca127177672d66b416965452f8/f21e7/Portfolio_Devlog_001.png 360w,\n/static/3ec7abca127177672d66b416965452f8/37523/Portfolio_Devlog_001.png 720w,\n/static/3ec7abca127177672d66b416965452f8/302a4/Portfolio_Devlog_001.png 1080w,\n/static/3ec7abca127177672d66b416965452f8/07a9c/Portfolio_Devlog_001.png 1440w,\n/static/3ec7abca127177672d66b416965452f8/49b61/Portfolio_Devlog_001.png 1756w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<hr>\n<h2 id=\"노션으로-옮기다\" style=\"position:relative;\"><a href=\"#%EB%85%B8%EC%85%98%EC%9C%BC%EB%A1%9C-%EC%98%AE%EA%B8%B0%EB%8B%A4\" aria-label=\"노션으로 옮기다 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>노션으로 옮기다.</h2>\n<p>원래 이 블로그에 작성하던 내용들이지만, 점점 글이 하나하나 늘어나다보니 가독성이나 블로그 관리가 조금 어려워졌습니다.\n처음엔 한 두~세 개 정도로 생각했는데 14개가 넘어가면서, 노션에 한 번에 정리하는 게 좋을 것 같다고 생각했습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABdklEQVQ4y5WTvUoDQRDH8wgW4b6Su927C5hLLqZQ01tYxEIs8gSCr+EL+IVFtImEIBYK+VIkF+wsvIgGLMUQCSJaqlgYFf3LrZyGaPRu4c/MsjO/HYaZgCiK6JUgCMxqmgZVVUEpZX7vW39srwKDgMlkEiOJBFKjYzBixo9E30DH8hwPqhBwHMfu/foNGhj0s67riBoGhqNR5hNCQAhlLVAUxXuFbqAsy9A1jcFcgCR9yo3xBOR5nsFyG3ns7ddQLFdRLFZQKlVRruyiZh1geWXVe4VOvwiluLq+hXu6AJ7xfU6bZz6BhOCi1cabA3p6x7ndROekgdf7Owa07YZ/YLt1yZI71gO2Zy0czs3jprCOx+4L6jXLew+dIEmSkE6nkclkMD01A9OcQGp8EoVcHpZVx8Likj+gY8NhmYEFUUAwOARR4rG5tYMj+xjZ7Jp/oGEYiEQiUGQFsqxApSpCIenPLfkHGEM8Hv/aadM0mZy5dIZ7UIUfenWlp+D7Rd4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Portfolio_Devlog_Notion\"\n        title=\"Portfolio_Devlog_Notion\"\n        src=\"/static/1bdec4604c27af87787d0a1ef704df56/37523/Portfolio_Devlog_002.png\"\n        srcset=\"/static/1bdec4604c27af87787d0a1ef704df56/e9ff0/Portfolio_Devlog_002.png 180w,\n/static/1bdec4604c27af87787d0a1ef704df56/f21e7/Portfolio_Devlog_002.png 360w,\n/static/1bdec4604c27af87787d0a1ef704df56/37523/Portfolio_Devlog_002.png 720w,\n/static/1bdec4604c27af87787d0a1ef704df56/302a4/Portfolio_Devlog_002.png 1080w,\n/static/1bdec4604c27af87787d0a1ef704df56/07a9c/Portfolio_Devlog_002.png 1440w,\n/static/1bdec4604c27af87787d0a1ef704df56/476e1/Portfolio_Devlog_002.png 1841w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<hr>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%EA%B0%9C%EB%B0%9C%EC%9D%BC%EC%A7%80\">개발일지</a></p>\n<ul>\n<li><a href=\"#%EC%98%B5%EC%8B%9C%EB%94%94%EC%96%B8%EC%9C%BC%EB%A1%9C-%EC%8B%9C%EC%9E%91\">옵시디언으로 시작</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EB%85%B8%EC%85%98%EC%9C%BC%EB%A1%9C-%EC%98%AE%EA%B8%B0%EB%8B%A4\">노션으로 옮기다.</a></p>\n</li>\n</ul>\n</div>","frontmatter":{"date":"December 10, 2024","title":"포트폴리오 사이트 개발일지","categories":"WORKS","author":"JunHyeong Moon","emoji":""},"fields":{"slug":"/Portfolio/PortfolioDev_000/"}},"site":{"siteMetadata":{"siteUrl":"https://junyangyee.github.io","comments":{"utterances":{"repo":""}}}}},"pageContext":{"slug":"/Blog/000_BlogReset/","nextSlug":"/Study/Unity_DevWeekURP/","prevSlug":"/Portfolio/PortfolioDev_000/"}},"staticQueryHashes":["1073350324","1956554647","2938748437"]}